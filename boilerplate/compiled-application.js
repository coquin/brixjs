var requirejs,require,define;!function(t){function e(t,e){return v.call(t,e)}function i(t,e){var i,n,r,s,o,a,l,c,u,h,p=e&&e.split("/"),d=g.map,f=d&&d["*"]||{};if(t&&"."===t.charAt(0))if(e){for(p=p.slice(0,p.length-1),t=p.concat(t.split("/")),c=0;c<t.length;c+=1)if(h=t[c],"."===h)t.splice(c,1),c-=1;else if(".."===h){if(1===c&&(".."===t[2]||".."===t[0]))break;c>0&&(t.splice(c-1,2),c-=2)}t=t.join("/")}else 0===t.indexOf("./")&&(t=t.substring(2));if((p||f)&&d){for(i=t.split("/"),c=i.length;c>0;c-=1){if(n=i.slice(0,c).join("/"),p)for(u=p.length;u>0;u-=1)if(r=d[p.slice(0,u).join("/")],r&&(r=r[n])){s=r,o=c;break}if(s)break;!a&&f&&f[n]&&(a=f[n],l=c)}!s&&a&&(s=a,o=l),s&&(i.splice(0,o,s),t=i.join("/"))}return t}function n(e,i){return function(){return u.apply(t,y.call(arguments,0).concat([e,i]))}}function r(t){return function(e){return i(e,t)}}function s(t){return function(e){d[t]=e}}function o(i){if(e(f,i)){var n=f[i];delete f[i],m[i]=!0,c.apply(t,n)}if(!e(d,i)&&!e(m,i))throw new Error("No "+i);return d[i]}function a(t){var e,i=t?t.indexOf("!"):-1;return i>-1&&(e=t.substring(0,i),t=t.substring(i+1,t.length)),[e,t]}function l(t){return function(){return g&&g.config&&g.config[t]||{}}}var c,u,h,p,d={},f={},g={},m={},v=Object.prototype.hasOwnProperty,y=[].slice;h=function(t,e){var n,s=a(t),l=s[0];return t=s[1],l&&(l=i(l,e),n=o(l)),l?t=n&&n.normalize?n.normalize(t,r(e)):i(t,e):(t=i(t,e),s=a(t),l=s[0],t=s[1],l&&(n=o(l))),{f:l?l+"!"+t:t,n:t,pr:l,p:n}},p={require:function(t){return n(t)},exports:function(t){var e=d[t];return"undefined"!=typeof e?e:d[t]={}},module:function(t){return{id:t,uri:"",exports:d[t],config:l(t)}}},c=function(i,r,a,l){var c,u,g,v,y,w,b=[];if(l=l||i,"function"==typeof a){for(r=!r.length&&a.length?["require","exports","module"]:r,y=0;y<r.length;y+=1)if(v=h(r[y],l),u=v.f,"require"===u)b[y]=p.require(i);else if("exports"===u)b[y]=p.exports(i),w=!0;else if("module"===u)c=b[y]=p.module(i);else if(e(d,u)||e(f,u)||e(m,u))b[y]=o(u);else{if(!v.p)throw new Error(i+" missing "+u);v.p.load(v.n,n(l,!0),s(u),{}),b[y]=d[u]}g=a.apply(d[i],b),i&&(c&&c.exports!==t&&c.exports!==d[i]?d[i]=c.exports:g===t&&w||(d[i]=g))}else i&&(d[i]=a)},requirejs=require=u=function(e,i,n,r,s){return"string"==typeof e?p[e]?p[e](i):o(h(e,i).f):(e.splice||(g=e,i.splice?(e=i,i=n,n=null):e=t),i=i||function(){},"function"==typeof n&&(n=r,r=s),r?c(t,e,i,n):setTimeout(function(){c(t,e,i,n)},15),u)},u.config=function(t){return g=t,u},define=function(t,i,n){i.splice||(n=i,i=[]),e(d,t)||e(f,t)||(f[t]=[t,i,n])},define.amd={jQuery:!0}}(),define("almond",function(){}),function(){var t=this,e=t._,i={},n=Array.prototype,r=Object.prototype,s=Function.prototype,o=n.push,a=n.slice,l=n.concat,c=r.toString,u=r.hasOwnProperty,h=n.forEach,p=n.map,d=n.reduce,f=n.reduceRight,g=n.filter,m=n.every,v=n.some,y=n.indexOf,w=n.lastIndexOf,b=Array.isArray,x=Object.keys,M=s.bind,k=function(t){return t instanceof k?t:this instanceof k?void(this._wrapped=t):new k(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=k),exports._=k):t._=k,k.VERSION="1.4.3";var S=k.each=k.forEach=function(t,e,n){if(null!=t)if(h&&t.forEach===h)t.forEach(e,n);else if(t.length===+t.length){for(var r=0,s=t.length;s>r;r++)if(e.call(n,t[r],r,t)===i)return}else for(var o in t)if(k.has(t,o)&&e.call(n,t[o],o,t)===i)return};k.map=k.collect=function(t,e,i){var n=[];return null==t?n:p&&t.map===p?t.map(e,i):(S(t,function(t,r,s){n[n.length]=e.call(i,t,r,s)}),n)};var _="Reduce of empty array with no initial value";k.reduce=k.foldl=k.inject=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),d&&t.reduce===d)return n&&(e=k.bind(e,n)),r?t.reduce(e,i):t.reduce(e);if(S(t,function(t,s,o){r?i=e.call(n,i,t,s,o):(i=t,r=!0)}),!r)throw new TypeError(_);return i},k.reduceRight=k.foldr=function(t,e,i,n){var r=arguments.length>2;if(null==t&&(t=[]),f&&t.reduceRight===f)return n&&(e=k.bind(e,n)),r?t.reduceRight(e,i):t.reduceRight(e);var s=t.length;if(s!==+s){var o=k.keys(t);s=o.length}if(S(t,function(a,l,c){l=o?o[--s]:--s,r?i=e.call(n,i,t[l],l,c):(i=t[l],r=!0)}),!r)throw new TypeError(_);return i},k.find=k.detect=function(t,e,i){var n;return C(t,function(t,r,s){return e.call(i,t,r,s)?(n=t,!0):void 0}),n},k.filter=k.select=function(t,e,i){var n=[];return null==t?n:g&&t.filter===g?t.filter(e,i):(S(t,function(t,r,s){e.call(i,t,r,s)&&(n[n.length]=t)}),n)},k.reject=function(t,e,i){return k.filter(t,function(t,n,r){return!e.call(i,t,n,r)},i)},k.every=k.all=function(t,e,n){e||(e=k.identity);var r=!0;return null==t?r:m&&t.every===m?t.every(e,n):(S(t,function(t,s,o){return(r=r&&e.call(n,t,s,o))?void 0:i}),!!r)};var C=k.some=k.any=function(t,e,n){e||(e=k.identity);var r=!1;return null==t?r:v&&t.some===v?t.some(e,n):(S(t,function(t,s,o){return r||(r=e.call(n,t,s,o))?i:void 0}),!!r)};k.contains=k.include=function(t,e){return null==t?!1:y&&t.indexOf===y?-1!=t.indexOf(e):C(t,function(t){return t===e})},k.invoke=function(t,e){var i=a.call(arguments,2);return k.map(t,function(t){return(k.isFunction(e)?e:t[e]).apply(t,i)})},k.pluck=function(t,e){return k.map(t,function(t){return t[e]})},k.where=function(t,e){return k.isEmpty(e)?[]:k.filter(t,function(t){for(var i in e)if(e[i]!==t[i])return!1;return!0})},k.max=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&k.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return S(t,function(t,r,s){var o=e?e.call(i,t,r,s):t;o>=n.computed&&(n={value:t,computed:o})}),n.value},k.min=function(t,e,i){if(!e&&k.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&k.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return S(t,function(t,r,s){var o=e?e.call(i,t,r,s):t;o<n.computed&&(n={value:t,computed:o})}),n.value},k.shuffle=function(t){var e,i=0,n=[];return S(t,function(t){e=k.random(i++),n[i-1]=n[e],n[e]=t}),n};var P=function(t){return k.isFunction(t)?t:function(e){return e[t]}};k.sortBy=function(t,e,i){var n=P(e);return k.pluck(k.map(t,function(t,e,r){return{value:t,index:e,criteria:n.call(i,t,e,r)}}).sort(function(t,e){var i=t.criteria,n=e.criteria;if(i!==n){if(i>n||void 0===i)return 1;if(n>i||void 0===n)return-1}return t.index<e.index?-1:1}),"value")};var E=function(t,e,i,n){var r={},s=P(e||k.identity);return S(t,function(e,o){var a=s.call(i,e,o,t);n(r,a,e)}),r};k.groupBy=function(t,e,i){return E(t,e,i,function(t,e,i){(k.has(t,e)?t[e]:t[e]=[]).push(i)})},k.countBy=function(t,e,i){return E(t,e,i,function(t,e){k.has(t,e)||(t[e]=0),t[e]++})},k.sortedIndex=function(t,e,i,n){i=null==i?k.identity:P(i);for(var r=i.call(n,e),s=0,o=t.length;o>s;){var a=s+o>>>1;i.call(n,t[a])<r?s=a+1:o=a}return s},k.toArray=function(t){return t?k.isArray(t)?a.call(t):t.length===+t.length?k.map(t,k.identity):k.values(t):[]},k.size=function(t){return null==t?0:t.length===+t.length?t.length:k.keys(t).length},k.first=k.head=k.take=function(t,e,i){return null==t?void 0:null==e||i?t[0]:a.call(t,0,e)},k.initial=function(t,e,i){return a.call(t,0,t.length-(null==e||i?1:e))},k.last=function(t,e,i){return null==t?void 0:null==e||i?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},k.rest=k.tail=k.drop=function(t,e,i){return a.call(t,null==e||i?1:e)},k.compact=function(t){return k.filter(t,k.identity)};var A=function(t,e,i){return S(t,function(t){k.isArray(t)?e?o.apply(i,t):A(t,e,i):i.push(t)}),i};k.flatten=function(t,e){return A(t,e,[])},k.without=function(t){return k.difference(t,a.call(arguments,1))},k.uniq=k.unique=function(t,e,i,n){k.isFunction(e)&&(n=i,i=e,e=!1);var r=i?k.map(t,i,n):t,s=[],o=[];return S(r,function(i,n){(e?n&&o[o.length-1]===i:k.contains(o,i))||(o.push(i),s.push(t[n]))}),s},k.union=function(){return k.uniq(l.apply(n,arguments))},k.intersection=function(t){var e=a.call(arguments,1);return k.filter(k.uniq(t),function(t){return k.every(e,function(e){return k.indexOf(e,t)>=0})})},k.difference=function(t){var e=l.apply(n,a.call(arguments,1));return k.filter(t,function(t){return!k.contains(e,t)})},k.zip=function(){for(var t=a.call(arguments),e=k.max(k.pluck(t,"length")),i=new Array(e),n=0;e>n;n++)i[n]=k.pluck(t,""+n);return i},k.object=function(t,e){if(null==t)return{};for(var i={},n=0,r=t.length;r>n;n++)e?i[t[n]]=e[n]:i[t[n][0]]=t[n][1];return i},k.indexOf=function(t,e,i){if(null==t)return-1;var n=0,r=t.length;if(i){if("number"!=typeof i)return n=k.sortedIndex(t,e),t[n]===e?n:-1;n=0>i?Math.max(0,r+i):i}if(y&&t.indexOf===y)return t.indexOf(e,i);for(;r>n;n++)if(t[n]===e)return n;return-1},k.lastIndexOf=function(t,e,i){if(null==t)return-1;var n=null!=i;if(w&&t.lastIndexOf===w)return n?t.lastIndexOf(e,i):t.lastIndexOf(e);for(var r=n?i:t.length;r--;)if(t[r]===e)return r;return-1},k.range=function(t,e,i){arguments.length<=1&&(e=t||0,t=0),i=arguments[2]||1;for(var n=Math.max(Math.ceil((e-t)/i),0),r=0,s=new Array(n);n>r;)s[r++]=t,t+=i;return s};var j=function(){};k.bind=function(t,e){var i,n;if(t.bind===M&&M)return M.apply(t,a.call(arguments,1));if(!k.isFunction(t))throw new TypeError;return i=a.call(arguments,2),n=function(){if(!(this instanceof n))return t.apply(e,i.concat(a.call(arguments)));j.prototype=t.prototype;var r=new j;j.prototype=null;var s=t.apply(r,i.concat(a.call(arguments)));return Object(s)===s?s:r}},k.bindAll=function(t){var e=a.call(arguments,1);return 0==e.length&&(e=k.functions(t)),S(e,function(e){t[e]=k.bind(t[e],t)}),t},k.memoize=function(t,e){var i={};return e||(e=k.identity),function(){var n=e.apply(this,arguments);return k.has(i,n)?i[n]:i[n]=t.apply(this,arguments)}},k.delay=function(t,e){var i=a.call(arguments,2);return setTimeout(function(){return t.apply(null,i)},e)},k.defer=function(t){return k.delay.apply(k,[t,1].concat(a.call(arguments,1)))},k.throttle=function(t,e){var i,n,r,s,o=0,a=function(){o=new Date,r=null,s=t.apply(i,n)};return function(){var l=new Date,c=e-(l-o);return i=this,n=arguments,0>=c?(clearTimeout(r),r=null,o=l,s=t.apply(i,n)):r||(r=setTimeout(a,c)),s}},k.debounce=function(t,e,i){var n,r;return function(){var s=this,o=arguments,a=function(){n=null,i||(r=t.apply(s,o))},l=i&&!n;return clearTimeout(n),n=setTimeout(a,e),l&&(r=t.apply(s,o)),r}},k.once=function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}},k.wrap=function(t,e){return function(){var i=[t];return o.apply(i,arguments),e.apply(this,i)}},k.compose=function(){var t=arguments;return function(){for(var e=arguments,i=t.length-1;i>=0;i--)e=[t[i].apply(this,e)];return e[0]}},k.after=function(t,e){return 0>=t?e():function(){return--t<1?e.apply(this,arguments):void 0}},k.keys=x||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var i in t)k.has(t,i)&&(e[e.length]=i);return e},k.values=function(t){var e=[];for(var i in t)k.has(t,i)&&e.push(t[i]);return e},k.pairs=function(t){var e=[];for(var i in t)k.has(t,i)&&e.push([i,t[i]]);return e},k.invert=function(t){var e={};for(var i in t)k.has(t,i)&&(e[t[i]]=i);return e},k.functions=k.methods=function(t){var e=[];for(var i in t)k.isFunction(t[i])&&e.push(i);return e.sort()},k.extend=function(t){return S(a.call(arguments,1),function(e){if(e)for(var i in e)t[i]=e[i]}),t},k.pick=function(t){var e={},i=l.apply(n,a.call(arguments,1));return S(i,function(i){i in t&&(e[i]=t[i])}),e},k.omit=function(t){var e={},i=l.apply(n,a.call(arguments,1));for(var r in t)k.contains(i,r)||(e[r]=t[r]);return e},k.defaults=function(t){return S(a.call(arguments,1),function(e){if(e)for(var i in e)null==t[i]&&(t[i]=e[i])}),t},k.clone=function(t){return k.isObject(t)?k.isArray(t)?t.slice():k.extend({},t):t},k.tap=function(t,e){return e(t),t};var V=function(t,e,i,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof k&&(t=t._wrapped),e instanceof k&&(e=e._wrapped);var r=c.call(t);if(r!=c.call(e))return!1;switch(r){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var s=i.length;s--;)if(i[s]==t)return n[s]==e;i.push(t),n.push(e);var o=0,a=!0;if("[object Array]"==r){if(o=t.length,a=o==e.length)for(;o--&&(a=V(t[o],e[o],i,n)););}else{var l=t.constructor,u=e.constructor;if(l!==u&&!(k.isFunction(l)&&l instanceof l&&k.isFunction(u)&&u instanceof u))return!1;for(var h in t)if(k.has(t,h)&&(o++,!(a=k.has(e,h)&&V(t[h],e[h],i,n))))break;if(a){for(h in e)if(k.has(e,h)&&!o--)break;a=!o}}return i.pop(),n.pop(),a};k.isEqual=function(t,e){return V(t,e,[],[])},k.isEmpty=function(t){if(null==t)return!0;if(k.isArray(t)||k.isString(t))return 0===t.length;for(var e in t)if(k.has(t,e))return!1;return!0},k.isElement=function(t){return!(!t||1!==t.nodeType)},k.isArray=b||function(t){return"[object Array]"==c.call(t)},k.isObject=function(t){return t===Object(t)},S(["Arguments","Function","String","Number","Date","RegExp"],function(t){k["is"+t]=function(e){return c.call(e)=="[object "+t+"]"}}),k.isArguments(arguments)||(k.isArguments=function(t){return!(!t||!k.has(t,"callee"))}),"function"!=typeof/./&&(k.isFunction=function(t){return"function"==typeof t}),k.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},k.isNaN=function(t){return k.isNumber(t)&&t!=+t},k.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==c.call(t)},k.isNull=function(t){return null===t},k.isUndefined=function(t){return void 0===t},k.has=function(t,e){return u.call(t,e)},k.noConflict=function(){return t._=e,this},k.identity=function(t){return t},k.times=function(t,e,i){for(var n=Array(t),r=0;t>r;r++)n[r]=e.call(i,r);return n},k.random=function(t,e){return null==e&&(e=t,t=0),t+(0|Math.random()*(e-t+1))};var T={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};T.unescape=k.invert(T.escape);var R={escape:new RegExp("["+k.keys(T.escape).join("")+"]","g"),unescape:new RegExp("("+k.keys(T.unescape).join("|")+")","g")};k.each(["escape","unescape"],function(t){k[t]=function(e){return null==e?"":(""+e).replace(R[t],function(e){return T[t][e]})}}),k.result=function(t,e){if(null==t)return null;var i=t[e];return k.isFunction(i)?i.call(t):i},k.mixin=function(t){S(k.functions(t),function(e){var i=k[e]=t[e];k.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),O.call(this,i.apply(k,t))}})};var U=0;k.uniqueId=function(t){var e=""+ ++U;return t?t+e:e},k.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,I={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\t|\u2028|\u2029/g;k.template=function(t,e,i){i=k.defaults({},i,k.templateSettings);var n=new RegExp([(i.escape||N).source,(i.interpolate||N).source,(i.evaluate||N).source].join("|")+"|$","g"),r=0,s="__p+='";t.replace(n,function(e,i,n,o,a){return s+=t.slice(r,a).replace(H,function(t){return"\\"+I[t]}),i&&(s+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'"),n&&(s+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(s+="';\n"+o+"\n__p+='"),r=a+e.length,e}),s+="';\n",i.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{var o=new Function(i.variable||"obj","_",s)}catch(a){throw a.source=s,a}if(e)return o(e,k);var l=function(t){return o.call(this,t,k)};return l.source="function("+(i.variable||"obj")+"){\n"+s+"}",l},k.chain=function(t){return k(t).chain()};var O=function(t){return this._chain?k(t).chain():t};k.mixin(k),S(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=n[t];k.prototype[t]=function(){var i=this._wrapped;return e.apply(i,arguments),"shift"!=t&&"splice"!=t||0!==i.length||delete i[0],O.call(this,i)}}),S(["concat","join","slice"],function(t){var e=n[t];k.prototype[t]=function(){return O.call(this,e.apply(this._wrapped,arguments))}}),k.extend(k.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return k})}.call(this),function(t,e){"undefined"!=typeof exports?e(t,exports,require("underscore")):"function"==typeof define&&define.amd?define("backbone",["underscore","jquery","exports"],function(i,n,r){t.Backbone=e(t,r,i,n)}):t.Backbone=e(t,{},t._,t.jQuery||t.Zepto||t.ender)}(this,function(t,e,i,n){var r=t.Backbone,s=[],o=s.push,a=s.slice,l=s.splice;e.VERSION="0.9.10",e.$=n,e.noConflict=function(){return t.Backbone=r,this},e.emulateHTTP=!1,e.emulateJSON=!1;var c=/\s+/,u=function(t,e,i,n){if(!i)return!0;if("object"==typeof i)for(var r in i)t[e].apply(t,[r,i[r]].concat(n));else{if(!c.test(i))return!0;for(var s=i.split(c),o=0,a=s.length;a>o;o++)t[e].apply(t,[s[o]].concat(n))}},h=function(t,e){var i,n=-1,r=t.length;switch(e.length){case 0:for(;++n<r;)(i=t[n]).callback.call(i.ctx);return;case 1:for(;++n<r;)(i=t[n]).callback.call(i.ctx,e[0]);return;case 2:for(;++n<r;)(i=t[n]).callback.call(i.ctx,e[0],e[1]);return;case 3:for(;++n<r;)(i=t[n]).callback.call(i.ctx,e[0],e[1],e[2]);return;default:for(;++n<r;)(i=t[n]).callback.apply(i.ctx,e)}},p=e.Events={on:function(t,e,i){if(!u(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var n=this._events[t]||(this._events[t]=[]);return n.push({callback:e,context:i,ctx:i||this}),this},once:function(t,e,n){if(!u(this,"once",t,[e,n])||!e)return this;var r=this,s=i.once(function(){r.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(t,s,n),this},off:function(t,e,n){var r,s,o,a,l,c,h,p;if(!this._events||!u(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(a=t?[t]:i.keys(this._events),l=0,c=a.length;c>l;l++)if(t=a[l],r=this._events[t]){if(o=[],e||n)for(h=0,p=r.length;p>h;h++)s=r[h],(e&&e!==s.callback&&e!==s.callback._callback||n&&n!==s.context)&&o.push(s);this._events[t]=o}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!u(this,"trigger",t,e))return this;var i=this._events[t],n=this._events.all;return i&&h(i,e),n&&h(n,arguments),this},listenTo:function(t,e,n){var r=this._listeners||(this._listeners={}),s=t._listenerId||(t._listenerId=i.uniqueId("l"));return r[s]=t,t.on(e,"object"==typeof e?this:n,this),this},stopListening:function(t,e,i){var n=this._listeners;if(n){if(t)t.off(e,"object"==typeof e?this:i,this),e||i||delete n[t._listenerId];else{"object"==typeof e&&(i=this);for(var r in n)n[r].off(e,i,this);this._listeners={}}return this}}};p.bind=p.on,p.unbind=p.off,i.extend(e,p);var d=e.Model=function(t,e){var n,r=t||{};this.cid=i.uniqueId("c"),this.attributes={},e&&e.collection&&(this.collection=e.collection),e&&e.parse&&(r=this.parse(r,e)||{}),(n=i.result(this,"defaults"))&&(r=i.defaults({},r,n)),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)};i.extend(d.prototype,p,{changed:null,idAttribute:"id",initialize:function(){},toJSON:function(){return i.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return i.escape(this.get(t))},has:function(t){return null!=this.get(t)},set:function(t,e,n){var r,s,o,a,l,c,u,h;if(null==t)return this;if("object"==typeof t?(s=t,n=e):(s={})[t]=e,n||(n={}),!this._validate(s,n))return!1;o=n.unset,l=n.silent,a=[],c=this._changing,this._changing=!0,c||(this._previousAttributes=i.clone(this.attributes),this.changed={}),h=this.attributes,u=this._previousAttributes,this.idAttribute in s&&(this.id=s[this.idAttribute]);for(r in s)e=s[r],i.isEqual(h[r],e)||a.push(r),i.isEqual(u[r],e)?delete this.changed[r]:this.changed[r]=e,o?delete h[r]:h[r]=e;if(!l){a.length&&(this._pending=!0);for(var p=0,d=a.length;d>p;p++)this.trigger("change:"+a[p],this,h[a[p]],n)}if(c)return this;if(!l)for(;this._pending;)this._pending=!1,this.trigger("change",this,n);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,i.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var n in this.attributes)e[n]=void 0;return this.set(e,i.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!i.isEmpty(this.changed):i.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?i.clone(this.changed):!1;var e,n=!1,r=this._changing?this._previousAttributes:this.attributes;for(var s in t)i.isEqual(r[s],e=t[s])||((n||(n={}))[s]=e);return n},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return i.clone(this._previousAttributes)},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success;return t.success=function(t,i,n){return t.set(t.parse(i,n),n)?void(e&&e(t,i,n)):!1},this.sync("read",this,t)},save:function(t,e,n){var r,s,o,a,l=this.attributes;return null==t||"object"==typeof t?(r=t,n=e):(r={})[t]=e,!r||n&&n.wait||this.set(r,n)?(n=i.extend({validate:!0},n),this._validate(r,n)?(r&&n.wait&&(this.attributes=i.extend({},l,r)),void 0===n.parse&&(n.parse=!0),s=n.success,n.success=function(t,e,n){t.attributes=l;var o=t.parse(e,n);return n.wait&&(o=i.extend(r||{},o)),i.isObject(o)&&!t.set(o,n)?!1:void(s&&s(t,e,n))},o=this.isNew()?"create":n.patch?"patch":"update","patch"===o&&(n.attrs=r),a=this.sync(o,this,n),r&&n.wait&&(this.attributes=l),a):!1):!1},destroy:function(t){t=t?i.clone(t):{};var e=this,n=t.success,r=function(){e.trigger("destroy",e,e.collection,t)};if(t.success=function(t,e,i){(i.wait||t.isNew())&&r(),n&&n(t,e,i)},this.isNew())return t.success(this,null,t),!1;var s=this.sync("delete",this,t);return t.wait||r(),s},url:function(){var t=i.result(this,"urlRoot")||i.result(this.collection,"url")||T();return this.isNew()?t:t+("/"===t.charAt(t.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(t){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},isValid:function(t){return!this.validate||!this.validate(this.attributes,t)},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=i.extend({},this.attributes,t);var n=this.validationError=this.validate(t,e)||null;return n?(this.trigger("invalid",this,n,e||{}),!1):!0}});var f=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this.models=[],this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,i.extend({silent:!0},e))};i.extend(f.prototype,p,{model:d,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){t=i.isArray(t)?t.slice():[t],e||(e={});var n,r,s,a,c,u,h,p,d,f;for(h=[],p=e.at,d=this.comparator&&null==p&&0!=e.sort,f=i.isString(this.comparator)?this.comparator:null,n=0,r=t.length;r>n;n++)(s=this._prepareModel(a=t[n],e))?(c=this.get(s))?e.merge&&(c.set(a===s?s.attributes:a,e),d&&!u&&c.hasChanged(f)&&(u=!0)):(h.push(s),s.on("all",this._onModelEvent,this),this._byId[s.cid]=s,null!=s.id&&(this._byId[s.id]=s)):this.trigger("invalid",this,a,e);if(h.length&&(d&&(u=!0),this.length+=h.length,null!=p?l.apply(this.models,[p,0].concat(h)):o.apply(this.models,h)),u&&this.sort({silent:!0}),e.silent)return this;for(n=0,r=h.length;r>n;n++)(s=h[n]).trigger("add",s,this,e);return u&&this.trigger("sort",this,e),this},remove:function(t,e){t=i.isArray(t)?t.slice():[t],e||(e={});var n,r,s,o;for(n=0,r=t.length;r>n;n++)o=this.get(t[n]),o&&(delete this._byId[o.id],delete this._byId[o.cid],s=this.indexOf(o),this.models.splice(s,1),this.length--,e.silent||(e.index=s,o.trigger("remove",o,this,e)),this._removeReference(o));return this},push:function(t,e){return t=this._prepareModel(t,e),this.add(t,i.extend({at:this.length},e)),t},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t),e},unshift:function(t,e){return t=this._prepareModel(t,e),this.add(t,i.extend({at:0},e)),t},shift:function(t){var e=this.at(0);return this.remove(e,t),e},slice:function(t,e){return this.models.slice(t,e)},get:function(t){return null==t?void 0:(this._idAttr||(this._idAttr=this.model.prototype.idAttribute),this._byId[t.id||t.cid||t[this._idAttr]||t])},at:function(t){return this.models[t]},where:function(t){return i.isEmpty(t)?[]:this.filter(function(e){for(var i in t)if(t[i]!==e.get(i))return!1;return!0})},sort:function(t){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return t||(t={}),i.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(i.bind(this.comparator,this)),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return i.invoke(this.models,"get",t)},update:function(t,e){e=i.extend({add:!0,merge:!0,remove:!0},e),e.parse&&(t=this.parse(t,e));var n,r,s,o,a=[],l=[],c={};if(i.isArray(t)||(t=t?[t]:[]),e.add&&!e.remove)return this.add(t,e);for(r=0,s=t.length;s>r;r++)n=t[r],o=this.get(n),e.remove&&o&&(c[o.cid]=!0),(e.add&&!o||e.merge&&o)&&a.push(n);if(e.remove)for(r=0,s=this.models.length;s>r;r++)n=this.models[r],c[n.cid]||l.push(n);return l.length&&this.remove(l,e),a.length&&this.add(a,e),this},reset:function(t,e){e||(e={}),e.parse&&(t=this.parse(t,e));for(var n=0,r=this.models.length;r>n;n++)this._removeReference(this.models[n]);return e.previousModels=this.models.slice(),this._reset(),t&&this.add(t,i.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),this},fetch:function(t){t=t?i.clone(t):{},void 0===t.parse&&(t.parse=!0);var e=t.success;return t.success=function(t,i,n){var r=n.update?"update":"reset";t[r](i,n),e&&e(t,i,n)},this.sync("read",this,t)},create:function(t,e){if(e=e?i.clone(e):{},!(t=this._prepareModel(t,e)))return!1;e.wait||this.add(t,e);var n=this,r=e.success;return e.success=function(t,e,i){i.wait&&n.add(t,i),r&&r(t,e,i)},t.save(null,e),t},parse:function(t){return t},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models.length=0,this._byId={}},_prepareModel:function(t,e){if(t instanceof d)return t.collection||(t.collection=this),t;e||(e={}),e.collection=this;var i=new this.model(t,e);return i._validate(t,e)?i:!1},_removeReference:function(t){this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,i,n){("add"!==t&&"remove"!==t||i===this)&&("destroy"===t&&this.remove(e,n),e&&t==="change:"+e.idAttribute&&(delete this._byId[e.previous(e.idAttribute)],null!=e.id&&(this._byId[e.id]=e)),this.trigger.apply(this,arguments))},sortedIndex:function(t,e,n){e||(e=this.comparator);var r=i.isFunction(e)?e:function(t){return t.get(e)};return i.sortedIndex(this.models,t,r,n)}});var g=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","indexOf","shuffle","lastIndexOf","isEmpty","chain"];i.each(g,function(t){f.prototype[t]=function(){var e=a.call(arguments);return e.unshift(this.models),i[t].apply(i,e)}});var m=["groupBy","countBy","sortBy"];i.each(m,function(t){f.prototype[t]=function(e,n){var r=i.isFunction(e)?e:function(t){return t.get(e)};return i[t](this.models,r,n)}});var v=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},y=/\((.*?)\)/g,w=/(\(\?)?:\w+/g,b=/\*\w+/g,x=/[\-{}\[\]+?.,\\\^$|#\s]/g;i.extend(v.prototype,p,{initialize:function(){},route:function(t,n,r){return i.isRegExp(t)||(t=this._routeToRegExp(t)),r||(r=this[n]),e.history.route(t,i.bind(function(i){var s=this._extractParameters(t,i);r&&r.apply(this,s),this.trigger.apply(this,["route:"+n].concat(s)),this.trigger("route",n,s),e.history.trigger("route",this,n,s)},this)),this},navigate:function(t,i){return e.history.navigate(t,i),this},_bindRoutes:function(){if(this.routes)for(var t,e=i.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])},_routeToRegExp:function(t){return t=t.replace(x,"\\$&").replace(y,"(?:$1)?").replace(w,function(t,e){return e?t:"([^/]+)"}).replace(b,"(.*?)"),new RegExp("^"+t+"$")},_extractParameters:function(t,e){return t.exec(e).slice(1)}});var M=e.History=function(){this.handlers=[],i.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},k=/^[#\/]|\s+$/g,S=/^\/+|\/+$/g,_=/msie [\w.]+/,C=/\/$/;M.started=!1,i.extend(M.prototype,p,{interval:50,getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getFragment:function(t,e){if(null==t)if(this._hasPushState||!this._wantsHashChange||e){t=this.location.pathname;var i=this.root.replace(C,"");t.indexOf(i)||(t=t.substr(i.length))}else t=this.getHash();return t.replace(k,"")},start:function(t){if(M.started)throw new Error("Backbone.history has already been started");M.started=!0,this.options=i.extend({},{root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var n=this.getFragment(),r=document.documentMode,s=_.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);this.root=("/"+this.root+"/").replace(S,"/"),s&&this._wantsHashChange&&(this.iframe=e.$('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(n)),this._hasPushState?e.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!s?e.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=n;var o=this.location,a=o.pathname.replace(/[^\/]$/,"$&/")===this.root;return this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!a?(this.fragment=this.getFragment(null,!0),this.location.replace(this.root+this.location.search+"#"+this.fragment),!0):(this._wantsPushState&&this._hasPushState&&a&&o.hash&&(this.fragment=this.getHash().replace(k,""),this.history.replaceState({},document.title,this.root+this.fragment+o.search)),this.options.silent?void 0:this.loadUrl())},stop:function(){e.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),M.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(){var t=this.getFragment();return t===this.fragment&&this.iframe&&(t=this.getFragment(this.getHash(this.iframe))),t===this.fragment?!1:(this.iframe&&this.navigate(t),void(this.loadUrl()||this.loadUrl(this.getHash())))},loadUrl:function(t){var e=this.fragment=this.getFragment(t),n=i.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0});return n},navigate:function(t,e){if(!M.started)return!1;if(e&&e!==!0||(e={trigger:e}),t=this.getFragment(t||""),this.fragment!==t){this.fragment=t;var i=this.root+t;if(this._hasPushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getFragment(this.getHash(this.iframe))&&(e.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,t,e.replace))}e.trigger&&this.loadUrl(t)}},_updateHash:function(t,e,i){if(i){var n=t.href.replace(/(javascript:|#).*$/,"");t.replace(n+"#"+e)}else t.hash="#"+e}}),e.history=new M;var P=e.View=function(t){this.cid=i.uniqueId("view"),this._configure(t||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},E=/^(\S+)\s*(.*)$/,A=["model","collection","el","id","attributes","className","tagName","events"];i.extend(P.prototype,p,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(t,i){return this.$el&&this.undelegateEvents(),this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0],i!==!1&&this.delegateEvents(),this
},delegateEvents:function(t){if(t||(t=i.result(this,"events"))){this.undelegateEvents();for(var e in t){var n=t[e];if(i.isFunction(n)||(n=this[t[e]]),!n)throw new Error('Method "'+t[e]+'" does not exist');var r=e.match(E),s=r[1],o=r[2];n=i.bind(n,this),s+=".delegateEvents"+this.cid,""===o?this.$el.on(s,n):this.$el.on(s,o,n)}}},undelegateEvents:function(){this.$el.off(".delegateEvents"+this.cid)},_configure:function(t){this.options&&(t=i.extend({},i.result(this,"options"),t)),i.extend(this,i.pick(t,A)),this.options=t},_ensureElement:function(){if(this.el)this.setElement(i.result(this,"el"),!1);else{var t=i.extend({},i.result(this,"attributes"));this.id&&(t.id=i.result(this,"id")),this.className&&(t["class"]=i.result(this,"className"));var n=e.$("<"+i.result(this,"tagName")+">").attr(t);this.setElement(n,!1)}}});var j={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.sync=function(t,n,r){var s=j[t];i.defaults(r||(r={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var o={type:s,dataType:"json"};if(r.url||(o.url=i.result(n,"url")||T()),null!=r.data||!n||"create"!==t&&"update"!==t&&"patch"!==t||(o.contentType="application/json",o.data=JSON.stringify(r.attrs||n.toJSON(r))),r.emulateJSON&&(o.contentType="application/x-www-form-urlencoded",o.data=o.data?{model:o.data}:{}),r.emulateHTTP&&("PUT"===s||"DELETE"===s||"PATCH"===s)){o.type="POST",r.emulateJSON&&(o.data._method=s);var a=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",s),a?a.apply(this,arguments):void 0}}"GET"===o.type||r.emulateJSON||(o.processData=!1);var l=r.success;r.success=function(t){l&&l(n,t,r),n.trigger("sync",n,t,r)};var c=r.error;r.error=function(t){c&&c(n,t,r),n.trigger("error",n,t,r)};var u=r.xhr=e.ajax(i.extend(o,r));return n.trigger("request",n,u,r),u},e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var V=function(t,e){var n,r=this;n=t&&i.has(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},i.extend(n,r,e);var s=function(){this.constructor=n};return s.prototype=r.prototype,n.prototype=new s,t&&i.extend(n.prototype,t),n.__super__=r.prototype,n};d.extend=f.extend=v.extend=P.extend=M.extend=V;var T=function(){throw new Error('A "url" property or function must be specified')};return e}),function(t,e){if("object"==typeof exports){var i=require("underscore"),n=require("backbone");module.exports=e(i,n)}else"function"==typeof define&&define.amd&&define("backbone.wreqr",["underscore","backbone"],e)}(this,function(t,e){"use strict";return e.Wreqr=function(t,e,i){var n={};return n.Handlers=function(t,e){var i=function(){this._handlers={}};return i.extend=t.Model.extend,e.extend(i.prototype,{addHandler:function(t,e,i){var n={callback:e,context:i};this._handlers[t]=n},getHandler:function(t){var e=this._handlers[t];if(!e)throw new Error("Handler not found for '"+t+"'");return function(){var t=Array.prototype.slice.apply(arguments);return e.callback.apply(e.context,t)}},removeHandler:function(t){delete this._handlers[t]},removeAllHandlers:function(){this._handlers={}}}),i}(t,i),n.Commands=function(t){return t.Handlers.extend({execute:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);this.getHandler(t).apply(this,e)}})}(n),n.RequestResponse=function(t){return t.Handlers.extend({request:function(){var t=arguments[0],e=Array.prototype.slice.call(arguments,1);return this.getHandler(t).apply(this,e)}})}(n),n.EventAggregator=function(t,e){var i=function(){};return i.extend=t.Model.extend,e.extend(i.prototype,t.Events),i}(t,i),n}(e,e.Marionette,t),e.Wreqr}),function(t,e){if("object"==typeof exports){var i=require("underscore"),n=require("backbone");module.exports=e(i,n)}else"function"==typeof define&&define.amd&&define("backbone.babysitter",["underscore","backbone"],e)}(this,function(t,e){"option strict";return e.ChildViewContainer=function(t,e){var i=function(t){this._views={},this._indexByModel={},this._indexByCollection={},this._indexByCustom={},this._updateLength(),this._addInitialViews(t)};e.extend(i.prototype,{add:function(t,e){var i=t.cid;this._views[i]=t,t.model&&(this._indexByModel[t.model.cid]=i),t.collection&&(this._indexByCollection[t.collection.cid]=i),e&&(this._indexByCustom[e]=i),this._updateLength()},findByModel:function(t){var e=this._indexByModel[t.cid];return this.findByCid(e)},findByCollection:function(t){var e=this._indexByCollection[t.cid];return this.findByCid(e)},findByCustom:function(t){var e=this._indexByCustom[t];return this.findByCid(e)},findByIndex:function(t){return e.values(this._views)[t]},findByCid:function(t){return this._views[t]},remove:function(t){var e=t.cid;t.model&&delete this._indexByModel[t.model.cid],t.collection&&delete this._indexByCollection[t.collection.cid];var i;for(var n in this._indexByCustom)if(this._indexByCustom.hasOwnProperty(n)&&this._indexByCustom[n]===e){i=n;break}i&&delete this._indexByCustom[i],delete this._views[e],this._updateLength()},call:function(t,e){e=Array.prototype.slice.call(arguments,1),this.apply(t,e)},apply:function(t,i){i=i||[],e.each(this._views,function(n){e.isFunction(n[t])&&n[t].apply(n,i)})},_updateLength:function(){this.length=e.size(this._views)},_addInitialViews:function(t){if(t){var e,i,n=t.length;for(i=0;n>i;i++)e=t[i],this.add(e)}}});var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return e.each(n,function(t){i.prototype[t]=function(){var i=e.values(this._views),n=[i].concat(e.toArray(arguments));return e[t].apply(e,n)}}),i}(e,t),e.ChildViewContainer}),function(t,e){if("object"==typeof exports){var i=require("jquery"),n=require("underscore"),r=require("backbone"),s=require("backbone.wreqr"),o=require("backbone.babysitter");module.exports=e(i,n,r,s,o)}else"function"==typeof define&&define.amd&&define("marionette",["jquery","underscore","backbone","backbone.wreqr","backbone.babysitter"],e)}(this,function(t,e,i){!function(t,e,i){"use strict";var n={};t.Marionette=n;var r=Array.prototype.slice;return n.extend=t.Model.extend,n.getOption=function(t,e){if(t&&e){var i;return i=t.options&&e in t.options&&void 0!==t.options[e]?t.options[e]:t[e]}},n.createObject=function(){function t(){}var e;return e="function"==typeof Object.create?Object.create:function(e){t.prototype=e;var i=new t;return t.prototype=null,i}}(),n.triggerMethod=function(){for(var t,i,n=Array.prototype.slice.apply(arguments),r=n[0],s=r.split(":"),o="on",a=0;a<s.length;a++)t=s[a],i=t.charAt(0).toUpperCase(),o+=i+t.slice(1);return this.trigger.apply(this,n),e.isFunction(this[o])?(n.shift(),this[o].apply(this,n)):void 0},n.MonitorDOMRefresh=function(){function t(t){t._isShown=!0,n(t)}function i(t){t._isRendered=!0,n(t)}function n(t){t._isShown&&t._isRendered&&e.isFunction(t.triggerMethod)&&t.triggerMethod("dom:refresh")}return function(e){e.listenTo(e,"show",function(){t(e)}),e.listenTo(e,"render",function(){i(e)})}}(),function(t){function i(t,i,n,r){var s=r.split(/\s+/);e.each(s,function(e){var r=t[e];if(!r)throw new Error("Method '"+e+"' was configured as an event handler, but does not exist.");t.listenTo(i,n,r,t)})}function n(t,e,i,n){t.listenTo(e,i,n,t)}function r(t,i,n,r){var s=r.split(/\s+/);e.each(s,function(){var e=t[e];t.stopListening(i,n,e,t)})}function s(t,e,i,n){t.stopListening(e,i,n,t)}function o(t,i,n,r,s){i&&n&&(e.isFunction(n)&&(n=n.call(t)),e.each(n,function(n,o){e.isFunction(n)?r(t,i,o,n):s(t,i,o,n)}))}t.bindEntityEvents=function(t,e,r){o(t,e,r,n,i)},t.unbindEntityEvents=function(t,e,i){o(t,e,i,s,r)}}(n),n.Callbacks=function(){this._deferred=i.Deferred(),this._callbacks=[]},e.extend(n.Callbacks.prototype,{add:function(t,e){this._callbacks.push({cb:t,ctx:e}),this._deferred.done(function(i,n){e&&(i=e),t.call(i,n)})},run:function(t,e){this._deferred.resolve(e,t)},reset:function(){var t=this,n=this._callbacks;this._deferred=i.Deferred(),this._callbacks=[],e.each(n,function(e){t.add(e.cb,e.ctx)})}}),n.Controller=function(t){this.triggerMethod=n.triggerMethod,this.options=t||{},e.isFunction(this.initialize)&&this.initialize(this.options)},n.Controller.extend=n.extend,e.extend(n.Controller.prototype,t.Events,{close:function(){this.stopListening(),this.triggerMethod("close"),this.unbind()}}),n.Region=function(t){if(this.options=t||{},this.el=n.getOption(this,"el"),!this.el){var e=new Error("An 'el' must be specified for a region.");throw e.name="NoElError",e}if(this.initialize){var i=Array.prototype.slice.apply(arguments);this.initialize.apply(this,i)}},e.extend(n.Region,{buildRegion:function(t,e){var i="string"==typeof t,n="string"==typeof t.selector,r="undefined"==typeof t.regionType,s="function"==typeof t;if(!s&&!i&&!n)throw new Error("Region must be specified as a Region type, a selector string or an object with selector property");var o,a;i&&(o=t),t.selector&&(o=t.selector),s&&(a=t),!s&&r&&(a=e),t.regionType&&(a=t.regionType);var l=new a({el:o});return l}}),e.extend(n.Region.prototype,t.Events,{show:function(t){this.ensureEl(),this.close(),t.render(),this.open(t),n.triggerMethod.call(t,"show"),n.triggerMethod.call(this,"show",t),this.currentView=t},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(t){return i(t)},open:function(t){this.$el.empty().append(t.el)},close:function(){var t=this.currentView;t&&!t.isClosed&&(t.close&&t.close(),n.triggerMethod.call(this,"close"),delete this.currentView)},attachView:function(t){this.currentView=t},reset:function(){this.close(),delete this.$el}}),n.Region.extend=n.extend,n.TemplateCache=function(t){this.templateId=t},e.extend(n.TemplateCache,{templateCaches:{},get:function(t){var e=this.templateCaches[t];return e||(e=new n.TemplateCache(t),this.templateCaches[t]=e),e.load()},clear:function(){var t,e=Array.prototype.slice.apply(arguments),i=e.length;if(i>0)for(t=0;i>t;t++)delete this.templateCaches[e[t]];else this.templateCaches={}}}),e.extend(n.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(t),this.compiledTemplate},loadTemplate:function(t){var e=i(t).html();if(!e||0===e.length){var n="Could not find template: '"+t+"'",r=new Error(n);throw r.name="NoTemplateError",r}return e},compileTemplate:function(t){return e.template(t)}}),n.Renderer={render:function(t,e){var i="function"==typeof t?t:n.TemplateCache.get(t),r=i(e);return r}},n.View=t.View.extend({constructor:function(){e.bindAll(this,"render");var i=Array.prototype.slice.apply(arguments);t.View.prototype.constructor.apply(this,i),n.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled,this)},triggerMethod:n.triggerMethod,getTemplate:function(){return n.getOption(this,"template")},mixinTemplateHelpers:function(t){t=t||{};var i=this.templateHelpers;return e.isFunction(i)&&(i=i.call(this)),e.extend(t,i)},configureTriggers:function(){if(this.triggers){var t=this,i={},n=e.result(this,"triggers");return e.each(n,function(e,n){i[n]=function(i){i&&i.preventDefault&&i.preventDefault(),i&&i.stopPropagation&&i.stopPropagation();var n={view:this,model:this.model,collection:this.collection};t.triggerMethod(e,n)}}),i}},delegateEvents:function(t){this._delegateDOMEvents(t),n.bindEntityEvents(this,this.model,n.getOption(this,"modelEvents")),n.bindEntityEvents(this,this.collection,n.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(i){i=i||this.events,e.isFunction(i)&&(i=i.call(this));var n={},r=this.configureTriggers();e.extend(n,i,r),t.View.prototype.delegateEvents.call(this,n)},undelegateEvents:function(){var e=Array.prototype.slice.call(arguments);t.View.prototype.undelegateEvents.apply(this,e),n.unbindEntityEvents(this,this.model,n.getOption(this,"modelEvents")),n.unbindEntityEvents(this,this.collection,n.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var t=this.triggerMethod("before:close");t!==!1&&(this.isClosed=!0,this.triggerMethod("close"),this.remove())}},bindUIElements:function(){if(this.ui){var t=this;this.uiBindings||(this.uiBindings=e.result(this,"ui")),this.ui={},e.each(e.keys(this.uiBindings),function(e){var i=t.uiBindings[e];t.ui[e]=t.$(i)})}}}),n.ItemView=n.View.extend({constructor:function(){var t=Array.prototype.slice.apply(arguments);n.View.prototype.constructor.apply(this,t)},serializeData:function(){var t={};return this.model?t=this.model.toJSON():this.collection&&(t={items:this.collection.toJSON()}),t},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var t=this.serializeData();t=this.mixinTemplateHelpers(t);var e=this.getTemplate(),i=n.Renderer.render(e,t);return this.$el.html(i),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){if(!this.isClosed){this.triggerMethod("item:before:close");var t=Array.prototype.slice.apply(arguments);n.View.prototype.close.apply(this,t),this.triggerMethod("item:closed")}}}),n.CollectionView=n.View.extend({itemViewEventPrefix:"itemview",constructor:function(){this._initChildViewStorage();var t=Array.prototype.slice.apply(arguments);n.View.prototype.constructor.apply(this,t),this._initialEvents()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.render,this))},addChildView:function(t){this.closeEmptyView();var e=this.getItemView(t),i=this.collection.indexOf(t);this.addItemView(t,e,i)},onShowCalled:function(){this.children.each(function(t){n.triggerMethod.call(t,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this.closeEmptyView(),this.closeChildren(),this.collection&&this.collection.length>0?this.showCollection():this.showEmptyView(),this.triggerRendered(),this},showCollection:function(){var t,e=this;this.collection.each(function(i,n){t=e.getItemView(i),e.addItemView(i,t,n)})},showEmptyView:function(){var e=n.getOption(this,"emptyView");if(e&&!this._showingEmptyView){this._showingEmptyView=!0;var i=new t.Model;this.addItemView(i,e,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getItemView:function(){var t=n.getOption(this,"itemView");if(!t){var e=new Error("An `itemView` must be specified");throw e.name="NoItemViewError",e}return t},addItemView:function(t,i,r){var s=n.getOption(this,"itemViewOptions");e.isFunction(s)&&(s=s.call(this,t));var o=this.buildItemView(t,i,s);this.addChildViewEventForwarding(o),this.triggerMethod("before:item:added",o),this.children.add(o),this._isShown&&n.triggerMethod.call(o,"show");this.renderItemView(o,r);this.triggerMethod("after:item:added",o)},addChildViewEventForwarding:function(t){var e=n.getOption(this,"itemViewEventPrefix");this.listenTo(t,"all",function(){var i=r.call(arguments);i[0]=e+":"+i[0],i.splice(1,0,t),n.triggerMethod.apply(this,i)},this)},renderItemView:function(t,e){t.render(),this.appendHtml(this,t,e)},buildItemView:function(t,i,n){var r=e.extend({model:t},n),s=new i(r);return s},removeItemView:function(t){var e=this.children.findByModel(t);this.removeChildView(e),this.checkEmpty()},removeChildView:function(t){t&&(this.stopListening(t),t.close&&t.close(),this.children.remove(t)),this.triggerMethod("item:removed",t)},checkEmpty:function(){this.collection&&0!==this.collection.length||this.showEmptyView()},appendHtml:function(t,e){t.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},close:function(){if(!this.isClosed){this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed");var t=Array.prototype.slice.apply(arguments);n.View.prototype.close.apply(this,t)}},closeChildren:function(){this.children.each(function(t){this.removeChildView(t)},this),this.checkEmpty()}}),n.CompositeView=n.CollectionView.extend({constructor:function(){var t=Array.prototype.slice.apply(arguments);n.CollectionView.apply(this,t),this.itemView=this.getItemView()},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView,this),this.listenTo(this.collection,"remove",this.removeItemView,this),this.listenTo(this.collection,"reset",this.renderCollection,this))},getItemView:function(){var t=n.getOption(this,"itemView")||this.constructor;if(!t){var e=new Error("An `itemView` must be specified");throw e.name="NoItemViewError",e}return t},serializeData:function(){var t={};return this.model&&(t=this.model.toJSON()),t},render:function(){this.isClosed=!1,this.resetItemViewContainer();var t=this.renderModel();return this.$el.html(t),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this.renderCollection(),this.triggerMethod("composite:rendered"),this},renderCollection:function(){var t=Array.prototype.slice.apply(arguments);n.CollectionView.prototype.render.apply(this,t),this.triggerMethod("composite:collection:rendered")},renderModel:function(){var t={};t=this.serializeData(),t=this.mixinTemplateHelpers(t);var e=this.getTemplate();return n.Renderer.render(e,t)},appendHtml:function(t,e){var i=this.getItemViewContainer(t);i.append(e.el)},getItemViewContainer:function(t){if("$itemViewContainer"in t)return t.$itemViewContainer;var i;if(t.itemViewContainer){var n=e.result(t,"itemViewContainer");if(i=t.$(n),i.length<=0){var r=new Error("The specified `itemViewContainer` was not found: "+t.itemViewContainer);throw r.name="ItemViewContainerMissingError",r}}else i=t.$el;return t.$itemViewContainer=i,i},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),n.Layout=n.ItemView.extend({regionType:n.Region,constructor:function(){this._firstRender=!0,this.initializeRegions();var t=Array.prototype.slice.apply(arguments);n.ItemView.apply(this,t)},render:function(){this._firstRender?this._firstRender=!1:(this.closeRegions(),this.reInitializeRegions());var t=Array.prototype.slice.apply(arguments),e=n.ItemView.prototype.render.apply(this,t);return e},close:function(){if(!this.isClosed){this.closeRegions(),this.destroyRegions();var t=Array.prototype.slice.apply(arguments);n.ItemView.prototype.close.apply(this,t)}},initializeRegions:function(){this.regionManagers||(this.regionManagers={});var t=this,i=this.regions||{};e.each(i,function(e,i){var r=n.Region.buildRegion(e,t.regionType);r.getEl=function(e){return t.$(e)},t.regionManagers[i]=r,t[i]=r})},reInitializeRegions:function(){this.regionManagers&&0===e.size(this.regionManagers)?this.initializeRegions():e.each(this.regionManagers,function(t){t.reset()})},closeRegions:function(){e.each(this.regionManagers,function(t){t.close()})},destroyRegions:function(){var t=this;e.each(this.regionManagers,function(e,i){delete t[i]}),this.regionManagers={}}}),n.AppRouter=t.Router.extend({constructor:function(e){var i=Array.prototype.slice.apply(arguments);if(t.Router.prototype.constructor.apply(this,i),this.options=e,this.appRoutes){var r=n.getOption(this,"controller");this.processAppRoutes(r,this.appRoutes)}},processAppRoutes:function(t,i){var n,r,s,o,a,l=[],c=this;for(s in i)i.hasOwnProperty(s)&&l.unshift([s,i[s]]);for(o=l.length,a=0;o>a;a++){if(s=l[a][0],r=l[a][1],n=t[r],!n){var u="Method '"+r+"' was not found on the controller",h=new Error(u);throw h.name="NoMethodError",h}n=e.bind(n,t),c.route(s,r,n)}}}),n.Application=function(i){this.initCallbacks=new n.Callbacks,this.vent=new t.Wreqr.EventAggregator,this.commands=new t.Wreqr.Commands,this.reqres=new t.Wreqr.RequestResponse,this.submodules={},e.extend(this,i),this.triggerMethod=n.triggerMethod},e.extend(n.Application.prototype,t.Events,{execute:function(){var t=Array.prototype.slice.apply(arguments);this.commands.execute.apply(this.commands,t)},request:function(){var t=Array.prototype.slice.apply(arguments);return this.reqres.request.apply(this.reqres,t)},addInitializer:function(t){this.initCallbacks.add(t)},start:function(t){this.triggerMethod("initialize:before",t),this.initCallbacks.run(t,this),this.triggerMethod("initialize:after",t),this.triggerMethod("start",t)},addRegions:function(t){var i=this;e.each(t,function(t,e){var r=n.Region.buildRegion(t,n.Region);i[e]=r})},removeRegion:function(t){this[t].close(),delete this[t]},module:function(){var t=r.call(arguments);return t.unshift(this),n.Module.create.apply(n.Module,t)}}),n.Application.extend=n.extend,n.Module=function(t,e){this.moduleName=t,this.submodules={},this._setupInitializersAndFinalizers(),this.app=e,this.startWithParent=!0,this.triggerMethod=n.triggerMethod},e.extend(n.Module.prototype,t.Events,{addInitializer:function(t){this._initializerCallbacks.add(t)},addFinalizer:function(t){this._finalizerCallbacks.add(t)},start:function(t){this._isInitialized||(e.each(this.submodules,function(e){var i=!0;i=e.startWithParent,i&&e.start(t)}),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,n.triggerMethod.call(this,"before:stop"),e.each(this.submodules,function(t){t.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),n.triggerMethod.call(this,"stop"))},addDefinition:function(t,e){this._runModuleDefinition(t,e)},_runModuleDefinition:function(r,s){if(r){var o=e.flatten([this,this.app,t,n,i,e,s]);r.apply(this,o)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new n.Callbacks,this._finalizerCallbacks=new n.Callbacks}}),e.extend(n.Module,{create:function(t,i,n){var s=this,o=t,a=r.apply(arguments);a.splice(0,3),i=i.split(".");var l=i.length,c=[];return c[l-1]=n,e.each(i,function(e,i){var n=o;o=s._getModule(n,e,t),s._addModuleDefinition(n,o,c[i],a)}),o},_getModule:function(t,e,i){var r=t[e];return r||(r=new n.Module(e,i),t[e]=r,t.submodules[e]=r),r},_addModuleDefinition:function(t,i,n,r){var s,o;e.isFunction(n)?(s=n,o=!0):e.isObject(n)?(s=n.define,o=n.startWithParent):o=!0,s&&i.addDefinition(s,r);i.startWithParent;i.startWithParent=i.startWithParent&&o,i.startWithParent&&!i.startWithParentIsConfigured&&(i.startWithParentIsConfigured=!0,t.addInitializer(function(t){i.startWithParent&&i.start(t)}))}}),n}(i,e,t||window.jQuery||window.Zepto||window.ender);return i.Marionette}),function(){var t={};!function(t){t.VERSION="1.0.rc.1",t.helpers={},t.partials={},t.registerHelper=function(t,e,i){i&&(e.not=i),this.helpers[t]=e},t.registerPartial=function(t,e){this.partials[t]=e},t.registerHelper("helperMissing",function(t){if(2===arguments.length)return void 0;throw new Error("Could not find property '"+t+"'")});var e=Object.prototype.toString,i="[object Function]";t.registerHelper("blockHelperMissing",function(n,r){var s=r.inverse||function(){},o=r.fn,a=e.call(n);return a===i&&(n=n.call(this)),n===!0?o(this):n===!1||null==n?s(this):"[object Array]"===a?n.length>0?t.helpers.each(n,r):s(this):o(n)}),t.K=function(){},t.createFrame=Object.create||function(e){t.K.prototype=e;var i=new t.K;return t.K.prototype=null,i},t.registerHelper("each",function(e,i){var n,r=i.fn,s=i.inverse,o="";if(i.data&&(n=t.createFrame(i.data)),e&&e.length>0)for(var a=0,l=e.length;l>a;a++)n&&(n.index=a),o+=r(e[a],{data:n});else o=s(this);return o}),t.registerHelper("if",function(n,r){var s=e.call(n);return s===i&&(n=n.call(this)),!n||t.Utils.isEmpty(n)?r.inverse(this):r.fn(this)}),t.registerHelper("unless",function(e,i){var n=i.fn,r=i.inverse;return i.fn=r,i.inverse=n,t.helpers["if"].call(this,e,i)}),t.registerHelper("with",function(t,e){return e.fn(t)}),t.registerHelper("log",function(e){t.log(e)})}(t),t.Exception=function(){var t=Error.prototype.constructor.apply(this,arguments);for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);this.message=t.message},t.Exception.prototype=new Error,t.SafeString=function(t){this.string=t},t.SafeString.prototype.toString=function(){return this.string.toString()},function(){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,n=/[&<>"'`]/,r=function(t){return e[t]||"&amp;"};t.Utils={escapeExpression:function(e){return e instanceof t.SafeString?e.toString():null==e||e===!1?"":n.test(e)?e.replace(i,r):e},isEmpty:function(t){return"undefined"==typeof t?!0:null===t?!0:t===!1?!0:"[object Array]"===Object.prototype.toString.call(t)&&0===t.length?!0:!1}}}(),t.Compiler=function(){},t.JavaScriptCompiler=function(){},function(e,i){e.prototype={compiler:e,disassemble:function(){for(var t,e,i,n=this.opcodes,r=[],s=0,o=n.length;o>s;s++)if(t=n[s],"DECLARE"===t.opcode)r.push("DECLARE "+t.name+"="+t.value);else{e=[];for(var a=0;a<t.args.length;a++)i=t.args[a],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),e.push(i);r.push(t.opcode+" "+e.join(" "))}return r.join("\n")},guid:0,compile:function(t,e){this.children=[],this.depths={list:[]},this.options=e;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var n in i)this.options.knownHelpers[n]=i[n];return this.program(t)},accept:function(t){return this[t.type](t)},program:function(t){var e,i=t.statements;this.opcodes=[];for(var n=0,r=i.length;r>n;n++)e=i[n],this[e.type](e);return this.isSimple=1===r,this.depths.list=this.depths.list.sort(function(t,e){return t-e}),this},compileProgram:function(t){var e,i=(new this.compiler).compile(t,this.options),n=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[n]=i;for(var r=0,s=i.depths.list.length;s>r;r++)e=i.depths.list[r],2>e||this.addDepth(e-1);return n},block:function(t){var e=t.mustache,i=t.program,n=t.inverse;i&&(i=this.compileProgram(i)),n&&(n=this.compileProgram(n));var r=this.classifyMustache(e);"helper"===r?this.helperMustache(e,i,n):"simple"===r?(this.simpleMustache(e),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("pushLiteral","{}"),this.opcode("blockValue")):(this.ambiguousMustache(e,i,n),this.opcode("pushProgram",i),this.opcode("pushProgram",n),this.opcode("pushLiteral","{}"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(t){var e,i,n=t.pairs;this.opcode("push","{}");for(var r=0,s=n.length;s>r;r++)e=n[r],i=e[1],this.accept(i),this.opcode("assignToHash",e[0])},partial:function(t){var e=t.id;this.usePartial=!0,t.context?this.ID(t.context):this.opcode("push","depth0"),this.opcode("invokePartial",e.original),this.opcode("append")},content:function(t){this.opcode("appendContent",t.string)},mustache:function(t){var e=this.options,i=this.classifyMustache(t);"simple"===i?this.simpleMustache(t):"helper"===i?this.helperMustache(t):this.ambiguousMustache(t),this.opcode(t.escaped&&!e.noEscape?"appendEscaped":"append")},ambiguousMustache:function(t,e,i){var n=t.id,r=n.parts[0];this.opcode("getContext",n.depth),this.opcode("pushProgram",e),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",r)},simpleMustache:function(t){var e=t.id;"DATA"===e.type?this.DATA(e):e.parts.length?this.ID(e):(this.addDepth(e.depth),this.opcode("getContext",e.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(t,e,i){var n=this.setupFullMustacheParams(t,e,i),r=t.id.parts[0];if(this.options.knownHelpers[r])this.opcode("invokeKnownHelper",n.length,r);else{if(this.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+r);this.opcode("invokeHelper",n.length,r)}},ID:function(t){this.addDepth(t.depth),this.opcode("getContext",t.depth);var e=t.parts[0];e?this.opcode("lookupOnContext",t.parts[0]):this.opcode("pushContext");for(var i=1,n=t.parts.length;n>i;i++)this.opcode("lookup",t.parts[i])},DATA:function(t){this.options.data=!0,this.opcode("lookupData",t.id)},STRING:function(t){this.opcode("pushString",t.string)},INTEGER:function(t){this.opcode("pushLiteral",t.integer)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},comment:function(){},opcode:function(t){this.opcodes.push({opcode:t,args:[].slice.call(arguments,1)})},declare:function(t,e){this.opcodes.push({opcode:"DECLARE",name:t,value:e})},addDepth:function(t){if(isNaN(t))throw new Error("EWOT");0!==t&&(this.depths[t]||(this.depths[t]=!0,this.depths.list.push(t)))},classifyMustache:function(t){var e=t.isHelper,i=t.eligibleHelper,n=this.options;if(i&&!e){var r=t.id.parts[0];n.knownHelpers[r]?e=!0:n.knownHelpersOnly&&(i=!1)}return e?"helper":i?"ambiguous":"simple"},pushParams:function(t){for(var e,i=t.length;i--;)e=t[i],this.options.stringParams?(e.depth&&this.addDepth(e.depth),this.opcode("getContext",e.depth||0),this.opcode("pushStringParam",e.string)):this[e.type](e)},setupMustacheParams:function(t){var e=t.params;return this.pushParams(e),t.hash?this.hash(t.hash):this.opcode("pushLiteral","{}"),e},setupFullMustacheParams:function(t,e,i){var n=t.params;return this.pushParams(n),this.opcode("pushProgram",e),this.opcode("pushProgram",i),t.hash?this.hash(t.hash):this.opcode("pushLiteral","{}"),n}};var n=function(t){this.value=t};i.prototype={nameLookup:function(t,e){return/^[0-9]+$/.test(e)?t+"["+e+"]":i.isValidJavaScriptVariableName(e)?t+"."+e:t+"['"+e+"']"},appendToBuffer:function(t){return this.environment.isSimple?"return "+t+";":"buffer += "+t+";"},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,i,n,r){this.environment=e,this.options=i||{},t.log(t.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.compileChildren(e,i);var s,o=e.opcodes;for(this.i=0,a=o.length;this.i<a;this.i++)s=o[this.i],"DECLARE"===s.opcode?this[s.name]=s.value:this[s.opcode].apply(this,s.args);return this.createFunctionContext(r)},nextOpcode:function(){{var t=this.environment.opcodes;t[this.i+1]}return t[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var t=[];if(this.isChild)t.push("");else{var e=this.namespace,i="helpers = helpers || "+e+".helpers;";this.environment.usePartial&&(i=i+" partials = partials || "+e+".partials;"),this.options.data&&(i+=" data = data || {};"),t.push(i)}t.push(this.environment.isSimple?"":", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=t},createFunctionContext:function(e){var i=this.stackVars.concat(this.registers.list);if(i.length>0&&(this.source[1]=this.source[1]+", "+i.join(", ")),!this.isChild){for(var n in this.context.aliases)this.source[1]=this.source[1]+", "+n+"="+this.context.aliases[n]}this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");for(var r=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],s=0,o=this.environment.depths.list.length;o>s;s++)r.push("depth"+this.environment.depths.list[s]);if(e)return r.push(this.source.join("\n  ")),Function.apply(this,r);var a="function "+(this.name||"")+"("+r.join(",")+") {\n  "+this.source.join("\n  ")+"}";return t.log(t.logger.DEBUG,a+"\n\n"),a},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t),this.replaceStack(function(e){return t.splice(1,0,e),e+" = blockHelperMissing.call("+t.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var t=["depth0"];this.setupParams(0,t);var e=this.topStack();t.splice(1,0,e),this.source.push("if (!"+this.lastHelper+") { "+e+" = blockHelperMissing.call("+t.join(", ")+"); }")
},appendContent:function(t){this.source.push(this.appendToBuffer(this.quotedString(t)))},append:function(){var t=this.popStack();this.source.push("if("+t+" || "+t+" === 0) { "+this.appendToBuffer(t)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){var t=this.nextOpcode(),e="";this.context.aliases.escapeExpression="this.escapeExpression",t&&"appendContent"===t.opcode&&(e=" + "+this.quotedString(t.args[0]),this.eat(t)),this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"+e))},getContext:function(t){this.lastContext!==t&&(this.lastContext=t)},lookupOnContext:function(t){this.pushStack(this.nameLookup("depth"+this.lastContext,t,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(t){return"typeof "+t+" === functionType ? "+t+".apply(depth0) : "+t})},lookup:function(t){this.replaceStack(function(e){return e+" == null || "+e+" === false ? "+e+" : "+this.nameLookup(e,t,"context")})},lookupData:function(t){this.pushStack(this.nameLookup("data",t,"data"))},pushStringParam:function(t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t)},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){this.pushStack(t)},pushLiteral:function(t){this.pushStackLiteral(t)},pushProgram:function(t){this.pushStackLiteral(null!=t?this.programExpression(t):null)},invokeHelper:function(t,e){this.context.aliases.helperMissing="helpers.helperMissing";var i=this.lastHelper=this.setupHelper(t,e);this.register("foundHelper",i.name),this.pushStack("foundHelper ? foundHelper.call("+i.callParams+") : helperMissing.call("+i.helperMissingParams+")")},invokeKnownHelper:function(t,e){var i=this.setupHelper(t,e);this.pushStack(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(t){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");var e=this.setupHelper(0,t),i=this.lastHelper=this.nameLookup("helpers",t,"helper");this.register("foundHelper",i);var n=this.nameLookup("depth"+this.lastContext,t,"context"),r=this.nextStack();this.source.push("if (foundHelper) { "+r+" = foundHelper.call("+e.callParams+"); }"),this.source.push("else { "+r+" = "+n+"; "+r+" = typeof "+r+" === functionType ? "+r+".apply(depth0) : "+r+"; }")},invokePartial:function(t){var e=[this.nameLookup("partials",t,"partial"),"'"+t+"'",this.popStack(),"helpers","partials"];this.options.data&&e.push("data"),this.context.aliases.self="this",this.pushStack("self.invokePartial("+e.join(", ")+");")},assignToHash:function(t){var e=this.popStack(),i=this.topStack();this.source.push(i+"['"+t+"'] = "+e+";")},compiler:i,compileChildren:function(t,e){for(var i,n,r=t.children,s=0,o=r.length;o>s;s++){i=r[s],n=new this.compiler,this.context.programs.push("");var a=this.context.programs.length;i.index=a,i.name="program"+a,this.context.programs[a]=n.compile(i,e,this.context)}},programExpression:function(t){if(this.context.aliases.self="this",null==t)return"self.noop";for(var e,i=this.environment.children[t],n=i.depths.list,r=[i.index,i.name,"data"],s=0,o=n.length;o>s;s++)e=n[s],r.push(1===e?"depth0":"depth"+(e-1));return 0===n.length?"self.program("+r.join(", ")+")":(r.shift(),"self.programWithDepth("+r.join(", ")+")")},register:function(t,e){this.useRegister(t),this.source.push(t+" = "+e+";")},useRegister:function(t){this.registers[t]||(this.registers[t]=!0,this.registers.list.push(t))},pushStackLiteral:function(t){return this.compileStack.push(new n(t)),t},pushStack:function(t){return this.source.push(this.incrStack()+" = "+t+";"),this.compileStack.push("stack"+this.stackSlot),"stack"+this.stackSlot},replaceStack:function(t){var e=t.call(this,this.topStack());return this.source.push(this.topStack()+" = "+e+";"),"stack"+this.stackSlot},nextStack:function(){var t=this.incrStack();return this.compileStack.push("stack"+this.stackSlot),t},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),"stack"+this.stackSlot},popStack:function(){var t=this.compileStack.pop();return t instanceof n?t.value:(this.stackSlot--,t)},topStack:function(){var t=this.compileStack[this.compileStack.length-1];return t instanceof n?t.value:t},quotedString:function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r")+'"'},setupHelper:function(t,e){var i=[];this.setupParams(t,i);var n=this.nameLookup("helpers",e,"helper");return{params:i,name:n,callParams:["depth0"].concat(i).join(", "),helperMissingParams:["depth0",this.quotedString(e)].concat(i).join(", ")}},setupParams:function(t,e){var i,n,r,s=[],o=[];s.push("hash:"+this.popStack()),n=this.popStack(),r=this.popStack(),(r||n)&&(r||(this.context.aliases.self="this",r="self.noop"),n||(this.context.aliases.self="this",n="self.noop"),s.push("inverse:"+n),s.push("fn:"+r));for(var a=0;t>a;a++)i=this.popStack(),e.push(i),this.options.stringParams&&o.push(this.popStack());return this.options.stringParams&&s.push("contexts:["+o.join(",")+"]"),this.options.data&&s.push("data:data"),e.push("{"+s.join(",")+"}"),e.join(", ")}};for(var r="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),s=i.RESERVED_WORDS={},o=0,a=r.length;a>o;o++)s[r[o]]=!0;i.isValidJavaScriptVariableName=function(t){return!i.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(t)?!0:!1}}(t.Compiler,t.JavaScriptCompiler),t.VM={template:function(e){var i={escapeExpression:t.Utils.escapeExpression,invokePartial:t.VM.invokePartial,programs:[],program:function(e,i,n){var r=this.programs[e];return n?t.VM.program(i,n):r?r:r=this.programs[e]=t.VM.program(i)},programWithDepth:t.VM.programWithDepth,noop:t.VM.noop};return function(n,r){return r=r||{},e.call(i,t,n,r.helpers,r.partials,r.data)}},programWithDepth:function(t,e){var i=Array.prototype.slice.call(arguments,2);return function(n,r){return r=r||{},t.apply(this,[n,r.data||e].concat(i))}},program:function(t,e){return function(i,n){return n=n||{},t(i,n.data||e)}},noop:function(){return""},invokePartial:function(e,i,n,r,s,o){var a={helpers:r,partials:s,data:o};if(void 0===e)throw new t.Exception("The partial "+i+" could not be found");if(e instanceof Function)return e(n,a);if(t.compile)return s[i]=t.compile(e,{data:void 0!==o}),s[i](n,a);throw new t.Exception("The partial "+i+" could not be compiled when running in runtime-only mode")}},t.template=t.VM.template,define("handlebars",[],function(){return t})}(),define("hbs",[],function(){return{get:function(){return Handlebars},write:function(t,e,i){if(e+customNameExtension in buildMap){var n=buildMap[e+customNameExtension];i.asModule(t+"!"+e,n)}},version:"0.4.0",load:function(){}}}),define("hbs!template/MainLayout",["hbs","handlebars"],function(t,e){var i=e.template(function(t,e,i){return i=i||t.helpers,'<div class="modal-placeholders"></div>\n<header>\n</header>\n<div class="main-content"></div>'});return e.registerPartial("template_MainLayout",i),i}),define("MainLayout",["marionette","hbs!template/MainLayout"],function(t,e){var i=t.Layout.extend({className:"container",template:e,regions:{modalRegion:".modal-placeholders",navigationRegion:"header",mainRegion:".main-content"}});return i}),function(t,e){if("object"==typeof exports){var i=require("underscore"),n=require("backbone"),r=require("marionette");module.exports=e(i,n,r)}else"function"==typeof define&&define.amd?define("brix",["underscore","backbone","marionette"],e):t.Brix=e(t._,t.Backbone,t.Backbone.Marionette)}(this,function(t,e,i){var n=function(t,e,i){"use strict";var n={};i.Brix=n;var r=e.Model.extend,s="/",o="place:change";n.Place=function(t){this.setParams(t)},n.Place.prototype={constructor:n.Place,schema:{},setParams:function(e){e=e||{},t.each(this.schema,function(i,n){var r=e[n];if(t.isNumber(i))this[n]=t.isUndefined(r)?i:Number(r);else if(t.isBoolean(i)){if(t.isString(r))switch(r.toLowerCase()){case"true":case"yes":case"1":r=!0;break;case"false":case"no":case"0":r=!1;break;default:r=Boolean(r)}this[n]=t.isUndefined(r)?i:Boolean(r)}else t.isString(i)?this[n]=t.isUndefined(r)?i:String(r):t.isUndefined(r)||(this[n]=r)},this)},equals:function(e){return t.all(t.keys(this.schema),function(t){return this[t]===e[t]},this)}},n.Place.extend=r,n.PlaceTokenizer=function(){},n.PlaceTokenizer.prototype={constructor:n.PlaceTokenizer,generateToken:function(e,i){var n=[e];return t.each(i.schema,function(e,i){var r=this[i];t.isUndefined(r)||r===e||n.push(i+"="+encodeURIComponent(r))},i),n.join(s)},parseToken:function(e,i){if(i&&t.isString(i)){var n={},r=i.split("/");t.each(r,function(t){var e=t.split("=");2===e.length&&(n[e[0]]=decodeURIComponent(e[1]))}),e.setParams(n)}return e}},n.PlaceTokenizer.extend=r;var a=null,l=null,c=!1;n.PlaceController=function(i){return l?l:(this.places=t.defaults(i||{},this.places),a||(a=new e.Router),l=this,this._placeTokenizer=t.isFunction(this.tokenizer)?new this.tokenizer:this.tokenizer,this)},t.extend(n.PlaceController.prototype,e.Events,{constructor:n.PlaceController,tokenizer:n.PlaceTokenizer,start:function(){if(!c){if(!t.isObject(this.places)||t.isEmpty(this.places))throw new Error("Brix.PlaceController should be initiated with place mappings");t.each(this.places,t.bind(function(t,e){this._bindPlace(e,t)},this)),c=!0,e.History.started||e.history.start()}},_bindPlace:function(e,i){if(t.isFunction(i)){var n=e;""===n||t.isEmpty(i.prototype.schema)||(n+="*params"),a.route(n,e,t.bind(function(t){var e=new i;e=this._placeTokenizer.parseToken(e,t),this._shouldSwitchPlace(e)&&(this.currentPlace=e,this.trigger(o,e))},this))}},_shouldSwitchPlace:function(t){var e=this.currentPlace;return e&&(e===t||e.constructor===t.constructor&&e.equals(t))?!1:!0},gotoPlace:function(e){if(!c)throw new Error("PlaceController is not started");if(this._shouldSwitchPlace(e)){var i=null;if(t.find(this.places,function(t,n){return e.constructor===t?(i=n,!0):!1}),null===i)throw new Error("No mappings defined for place");var n=this._placeTokenizer.generateToken(i,e);this.currentPlace=e,a.navigate(n,{trigger:!1}),this.trigger(o,e)}}}),n.PlaceController.extend=r,n.Module=function(){},t.extend(n.Module.prototype,e.Events,{constructor:n.Module,start:function(){},stop:function(){}}),n.Module.extend=r,n.Activity=function(){this.initialize.apply(this,arguments)},t.extend(n.Activity.prototype,e.Events,{constructor:n.Activity,initialize:function(){},start:function(){},stop:function(){return!0}}),n.Activity.extend=r,n.SimpleActivity=n.Activity.extend({constructor:function(e){if(e&&(t.isFunction(e)?this.view=e:t.isFunction(e.view)&&(this.view=e.view)),n.Activity.prototype.constructor.apply(this,arguments),!t.isFunction(this.view))throw new Error("SimpleActivity should be initiated with view class")},view:null,start:function(t){var e=this.view;t.show(new e)}});var u=function(){this.currentActivity&&(this.currentActivity.stop(null),this.currentActivity.stopListening(),delete this.currentActivity)},h=function(e){if(!e)return void u.call(this);var i=this.mapper(e);if(i){if(t.isBoolean(i))return void u.call(this);if(this.currentActivity){if(this.currentActivity.stop(e)===!1)return;this.currentActivity.stopListening()}this.currentActivity=i,i.start(this.region,e)}};n.ActivityManager=n.Module.extend({constructor:function(e){t.isFunction(e)&&(this.mapper=e),this.initialize.apply(this,arguments)},initialize:function(){},mapper:function(){return null},start:function(t,e,i){this.stop(),this.region=e,this.listenTo(t,o,h),i&&h.call(this,i)},stop:function(){this.stopListening(),u.call(this),this.region&&(this.region.close(),delete this.region)}});var p=function(){this.currentManager&&(this.currentManager.stop(),this.currentManager.stopListening(),delete this.currentManager)},d=function(t){if(!t)return void p.call(this);var e=this.mapper(t);if(e){if(!(e instanceof n.Module))throw new Error("Class should extend from Brix.Module");p.call(this),this.currentManager=e,e.start(this,this.region,t)}};return n.DelegateManager=n.Module.extend({constructor:function(e){t.isFunction(e)&&(this.mapper=e),this.initialize.apply(this,arguments)},initialize:function(){},mapper:function(){return null},start:function(t,e,i){this.stop(),this.region=e,this.listenTo(t,o,d),i&&d.call(this,i)},stop:function(){this.stopListening(),p.call(this),this.region&&(this.region.close(),delete this.region)}}),n.CompositeManager=n.Module.extend({constructor:function(e){e&&(this.layoutView=e.layoutView||this.layoutView,this.regions=e.regions||this.regions),t.isFunction(this.regions)&&(this.regions=this.regions()),this.initialize.apply(this,arguments)},initialize:function(){},layoutView:null,regions:null,start:function(e,i,r){this.stop();var s=this.layoutView,o=new s;i.show(o),this.layout=o;var a=[];t.each(this.regions,function(i,s){var l;if(l=t.isFunction(i)?new i:i,l instanceof n.Activity){var c=l;l=new n.ActivityManager(function(){return c})}else if(!(l instanceof n.Module))throw new Error("Class should extend from Brix.Module or Brix.Activity");l.start(e,o[s],r),a.push(l)}),this.managers=a},stop:function(){this.managers&&(t.each(this.managers,function(t){t.stop()}),delete this.managers),this.layout&&(this.layout.close(),delete this.layout)}}),n}(t,e,i);return n}),define("places/ProfilePlace",["brix"],function(t){var e=t.Place.extend({name:"profile"});return e}),define("places/SettingsPlace",["brix"],function(t){var e=t.Place.extend({name:"settings"});return e}),define("places/SubSettingsPlace",["places/SettingsPlace"],function(t){return t.extend({name:"sub-settings"})}),define("places/ModalWindowPlace",["places/SubSettingsPlace"],function(t){return t.extend({name:"modal-window"})}),define("places/mapping",["places/ProfilePlace","places/SettingsPlace","places/SubSettingsPlace","places/ModalWindowPlace"],function(t,e,i,n){return{"":t,profile:t,settings:e,"sub-settings":i,"modal-window":n}}),define("placeController",["brix","places/mapping"],function(t,e){return new t.PlaceController(e)}),define("hbs!template/navigation/NavigationView",["hbs","handlebars"],function(t,e){var i=e.template(function(t,e,i){return i=i||t.helpers,'<div class="navbar-inner">\n    <div class="container">\n        <a class="brand" href="http://brixjs.com">BrixJS Application</a>\n        <ul class="nav">\n            <li class="profile active"><a href="#">Profile</a></li>\n            <li class="settings"><a href="#">Settings</a></li>\n        </ul>\n    </div>\n</div>'});return e.registerPartial("template_navigation_NavigationView",i),i}),define("module/navigation/view/NavigationView",["marionette","hbs!template/navigation/NavigationView"],function(t,e){var i=t.ItemView.extend({className:"navbar navbar-fixed-top",template:e,triggers:{"click .profile":"goto:profile","click .settings":"goto:settings"},highlightTab:function(t){this.$(".nav li").removeClass("active"),this.$(".nav li."+t).addClass("active")}});return i}),define("module/navigation/activity/NavigationActivity",["brix","module/navigation/view/NavigationView","placeController","places/ProfilePlace","places/SettingsPlace"],function(t,e,i,n,r){var s=t.Activity.extend({start:function(t,i){var n=new e;t.show(n),this.listenTo(n,"goto:profile",this.gotoProfile),this.listenTo(n,"goto:settings",this.gotoSettings),this.view=n,this.highlightActiveTab(i)},stop:function(t){return this.highlightActiveTab(t),!1},gotoProfile:function(){i.gotoPlace(new n)},gotoSettings:function(){i.gotoPlace(new r)},highlightActiveTab:function(t){t instanceof n&&this.view.highlightTab("profile"),t instanceof r&&this.view.highlightTab("settings")}});return s}),define("module/navigation/NavigationModule",["brix","module/navigation/activity/NavigationActivity"],function(t,e){return t.ActivityManager.extend({mapper:function(){return new e}})}),define("template/helpers/githubUrl",["handlebars","underscore"],function(t,e){"use strict";function i(i,n){var r="https://github.com/beenokle/brixjs/blob/master/boilerplate/js/"+i;return e.isString(n)||(n=i),new t.SafeString("<a href='"+r+"' target='_blank'>"+n+"</a>")}return t.registerHelper("githubUrl",i),i}),define("hbs!template/profile/ProfileView",["hbs","handlebars","template/helpers/githubUrl"],function(t,e){var i=e.template(function(t,e,i){i=i||t.helpers;var n,r,s="",o=i.helperMissing,a=this.escapeExpression;return s+="<h1>Welcome</h1>\n<p>What was happened when you opened this page:</p>\n<ol>\n    <li>Loaded and started ",r=i.githubUrl,n=r?r.call(e,"application.js",{hash:{}}):o.call(e,"githubUrl","application.js",{hash:{}}),s+=a(n)+"</li>\n    <li>Via RequireJS it gets all the dependencies, one is instance of Brix.PlaceController\n        - ",r=i.githubUrl,n=r?r.call(e,"placeController.js",{hash:{}}):o.call(e,"githubUrl","placeController.js",{hash:{}}),s+=a(n)+"</li>\n    <li>It creates instance of ",r=i.githubUrl,n=r?r.call(e,"MainLayout.js",{hash:{}}):o.call(e,"githubUrl","MainLayout.js",{hash:{}}),s+=a(n)+" and renders right into html body</li>\n    <li>MainLayout defines two regions - top header and main region</li>\n    <li>Then application.js starts three Modules (ActivityManagers)\n        <ul>\n            <li>",r=i.githubUrl,n=r?r.call(e,"module/navigation/NavigationModule.js","NavigationModule.js",{hash:{}}):o.call(e,"githubUrl","module/navigation/NavigationModule.js","NavigationModule.js",{hash:{}}),s+=a(n)+" will be responsible for\n                header region\n            </li>\n            <li>",r=i.githubUrl,n=r?r.call(e,"module/MainModule.js","MainModule.js",{hash:{}}):o.call(e,"githubUrl","module/MainModule.js","MainModule.js",{hash:{}}),s+=a(n)+" will be responsible for main content region</li>\n            <li>",r=i.githubUrl,n=r?r.call(e,"module/ModalWindowsModule.js","ModalWindowsModule.js",{hash:{}}):o.call(e,"githubUrl","module/ModalWindowsModule.js","ModalWindowsModule.js",{hash:{}}),s+=a(n)+' will be responsible for modal windows region - we will review it later</li>\n        </ul>\n        All the modules listen to "place:change" event from placeController\n    </li>\n    <li>Then placeController is started</li>\n    <li>Because of ',r=i.githubUrl,n=r?r.call(e,"places/mapping.js","mapping.js",{hash:{}}):o.call(e,"githubUrl","places/mapping.js","mapping.js",{hash:{}}),s+=a(n)+" placeController creates instance\n        of ",r=i.githubUrl,n=r?r.call(e,"places/ProfilePlace.js","ProfilePlace.js",{hash:{}}):o.call(e,"githubUrl","places/ProfilePlace.js","ProfilePlace.js",{hash:{}}),s+=a(n)+" and fires place change event.<br/>\n        Now both modules receive this event and do futher logic<br/>\n        <b>NavigationModule:</b><br/>\n        <ol>\n            <li>For every place this module has single mapping that creates instance\n                of ",r=i.githubUrl,n=r?r.call(e,"module/navigation/activity/NavigationActivity.js","NavigationActivity.js",{hash:{}}):o.call(e,"githubUrl","module/navigation/activity/NavigationActivity.js","NavigationActivity.js",{hash:{}}),s+=a(n)+"</li>\n            <li>This instance is started and is given with region (top header)</li>\n            <li>Activity creates instance\n                of ",r=i.githubUrl,n=r?r.call(e,"module/navigation/view/NavigationView.js","NavigationView.js",{hash:{}}):o.call(e,"githubUrl","module/navigation/view/NavigationView.js","NavigationView.js",{hash:{}}),s+=a(n)+" and asks region to show\n                this view\n            </li>\n            <li>After it activity subscribes to events from view (menu clicks) and asks view to highlight current menu\n            </li>\n        </ol>\n        <b>MainModule:</b><br/>\n        <ol>\n            <li>Main module is CompositeManager and just delegates region controlling to some particular module\n                depending of current place\n            </li>\n            <li>Because current place is ProfilePlace it creates instance\n                of ",r=i.githubUrl,n=r?r.call(e,"module/profile/ProfileModule.js","ProfileModule.js",{hash:{}}):o.call(e,"githubUrl","module/profile/ProfileModule.js","ProfileModule.js",{hash:{}}),s+=a(n)+" and starts it\n            </li>\n            <li>ProfileModule starts ",r=i.githubUrl,n=r?r.call(e,"module/profile/activity/ProfileActivity.js","ProfileActivity.js",{hash:{}}):o.call(e,"githubUrl","module/profile/activity/ProfileActivity.js","ProfileActivity.js",{hash:{}}),s+=a(n)+"\n                that renders ",r=i.githubUrl,n=r?r.call(e,"module/profile/view/ProfileView.js","ProfileView.js",{hash:{}}):o.call(e,"githubUrl","module/profile/view/ProfileView.js","ProfileView.js",{hash:{}}),s+=a(n)+' into main region\n            </li>\n            <li>So you see this text!</li>\n        </ol>\n    </li>\n</ol>\n<p>Now lets see what will happen when you click on "Settings" menu</p>'});return e.registerPartial("template_profile_ProfileView",i),i}),define("module/profile/view/ProfileView",["marionette","hbs!template/profile/ProfileView"],function(t,e){var i=t.ItemView.extend({template:e});return i}),define("module/profile/activity/ProfileActivity",["brix","module/profile/view/ProfileView"],function(t,e){var i=t.Activity.extend({start:function(t){this.view=new e,t.show(this.view)},stop:function(){return!0}});return i}),define("module/profile/ProfileModule",["brix","module/profile/activity/ProfileActivity","places/ProfilePlace"],function(t,e,i){return t.ActivityManager.extend({mapper:function(t){return t instanceof i?new e:null}})}),define("hbs!template/settings/SubSettingsView",["hbs","handlebars","template/helpers/githubUrl"],function(t,e){var i=e.template(function(t,e,i){i=i||t.helpers;var n,r,s="",o=i.helperMissing,a=this.escapeExpression;return s+="<h4>Right Column Region</h4>\n<p>Wow! Here is another trick!</p>\n<p>",r=i.githubUrl,n=r?r.call(e,"places/SubSettingsPlace.js","SubSettingsPlace",{hash:{}}):o.call(e,"githubUrl","places/SubSettingsPlace.js","SubSettingsPlace",{hash:{}}),s+=a(n)+" extends\n    from ",r=i.githubUrl,n=r?r.call(e,"places/SettingsPlace.js","SettingsPlace",{hash:{}}):o.call(e,"githubUrl","places/SettingsPlace.js","SettingsPlace",{hash:{}}),s+=a(n)+" (sub-place), so:</p>\n<ul>\n    <li>",r=i.githubUrl,n=r?r.call(e,"module/navigation/activity/NavigationActivity.js","NavigationActivity",{hash:{}}):o.call(e,"githubUrl","module/navigation/activity/NavigationActivity.js","NavigationActivity",{hash:{}}),s+=a(n)+' highlights "right" menu\n    </li>\n    <li>MainModule still delegates place change events to SettingsModule</li>\n    <li>',r=i.githubUrl,n=r?r.call(e,"module/settings/activity/LeftColumnActivity.js","LeftColumnActivity",{hash:{}}):o.call(e,"githubUrl","module/settings/activity/LeftColumnActivity.js","LeftColumnActivity",{hash:{}}),s+=a(n)+' decides not to stop, so the\n        only region re-rendered is this Right Column region. Profit!\n    </li>\n</ul>\n<p>And I\'d like to show you how to deal with modal windows</p>\n<a href="#" class="btn btn-small">Open Modal Window</a>'});return e.registerPartial("template_settings_SubSettingsView",i),i}),define("module/settings/view/SubSettingsView",["marionette","hbs!template/settings/SubSettingsView"],function(t,e){return t.ItemView.extend({template:e,triggers:{"click .btn":"show:modal"}})}),define("module/settings/activity/SubSettingsActivity",["brix","module/settings/view/SubSettingsView","placeController","places/SubSettingsPlace","places/ModalWindowPlace"],function(t,e,i,n,r){return t.Activity.extend({start:function(t){var n=new e;t.show(n),this.listenTo(n,"show:modal",function(){i.gotoPlace(new r)})},stop:function(t){return t instanceof n?!1:void 0}})}),define("hbs!template/settings/LeftColumnView",["hbs","handlebars","template/helpers/githubUrl"],function(t,e){var i=e.template(function(t,e,i){i=i||t.helpers;var n,r,s="",o=i.helperMissing,a=this.escapeExpression;return s+="<h4>Left Column</h4>\n<p>When you click on the button below,\n    ",r=i.githubUrl,n=r?r.call(e,"module/settings/activity/LeftColumnActivity.js","LeftColumnActivity",{hash:{}}):o.call(e,"githubUrl","module/settings/activity/LeftColumnActivity.js","LeftColumnActivity",{hash:{}}),s+=a(n)+" will ask placeController to\n    switch to ",r=i.githubUrl,n=r?r.call(e,"places/SubSettingsPlace.js","SubSettingsPlace",{hash:{}}):o.call(e,"githubUrl","places/SubSettingsPlace.js","SubSettingsPlace",{hash:{}}),s+=a(n)+'\n</p>\n<a class="btn btn-small">Change Right</a>'});return e.registerPartial("template_settings_LeftColumnView",i),i}),define("module/settings/view/LeftColumnView",["marionette","hbs!template/settings/LeftColumnView"],function(t,e){var i=t.ItemView.extend({template:e,triggers:{"click .btn":"goto:subsettings"}});return i}),define("module/settings/activity/LeftColumnActivity",["brix","placeController","module/settings/view/LeftColumnView","places/SettingsPlace","places/SubSettingsPlace"],function(t,e,i,n,r){return t.Activity.extend({start:function(t){var n=new i;t.show(n),this.listenTo(n,"goto:subsettings",function(){e.gotoPlace(new r)})},stop:function(t){return!(t instanceof n)}})}),define("hbs!template/settings/RightColumnView",["hbs","handlebars"],function(t,e){var i=e.template(function(t,e,i){return i=i||t.helpers,"<h4>Right Column</h4>\n<p>bla-bla-bla</p>"});return e.registerPartial("template_settings_RightColumnView",i),i}),define("module/settings/view/RightColumnView",["marionette","hbs!template/settings/RightColumnView"],function(t,e){var i=t.ItemView.extend({template:e,triggers:{"click .btn":"goto:subsettings"}});return i}),define("module/settings/activity/RightColumnActivity",["brix","module/settings/view/RightColumnView"],function(t,e){return t.SimpleActivity.extend({view:e})}),define("hbs!template/settings/SettingsModuleView",["hbs","handlebars","template/helpers/githubUrl"],function(t,e){var i=e.template(function(t,e,i){i=i||t.helpers;var n,r,s="",o=i.helperMissing,a=this.escapeExpression;return s+="<h1>Settings Module</h1>\n<p>You see this page because current place is SettingPlace - take a look at address bar.</p>\n<p>",r=i.githubUrl,n=r?r.call(e,"module/settings/SettingsModule.js","SettingsModule",{hash:{}}):o.call(e,"githubUrl","module/settings/SettingsModule.js","SettingsModule",{hash:{}}),s+=a(n)+" is a CompositeManager associated\n    with ",r=i.githubUrl,n=r?r.call(e,"module/settings/SettingsModuleView.js","SettingsModuleView",{hash:{}}):o.call(e,"githubUrl","module/settings/SettingsModuleView.js","SettingsModuleView",{hash:{}}),s+=a(n)+' - that defines two column-regions\n    and has this text</p>\n<p>When you clicked on "Settings" menu link the following was happened:</p>\n<ol>\n    <li>',r=i.githubUrl,n=r?r.call(e,"module/navigation/view/NavigationView.js","NavigationView",{hash:{}}):o.call(e,"githubUrl","module/navigation/view/NavigationView.js","NavigationView",{hash:{}}),s+=a(n)+' fired event that custom user action\n        occured via Marionette triggers (thanks <a href="http://lostechies.com/derickbailey/">Derick</a> for that!)\n    </li>\n    <li>',r=i.githubUrl,n=r?r.call(e,"module/navigation/activity/NavigationActivity.js","NavigationActivity",{hash:{}}):o.call(e,"githubUrl","module/navigation/activity/NavigationActivity.js","NavigationActivity",{hash:{}}),s+=a(n)+" received event from view,\n        created instance of place and asked ",r=i.githubUrl,n=r?r.call(e,"placeController.js","placeController",{hash:{}}):o.call(e,"githubUrl","placeController.js","placeController",{hash:{}}),s+=a(n)+' to change current place<br/>\n        <span class="label">Hint</span> I recommend you to create places via some builders (to save parameters and page\n        state).\n    </li>\n    <li>Current place is changed and the magic begins</li>\n    <li>',r=i.githubUrl,n=r?r.call(e,"module/navigation/NavigationModule.js","NavigationModule",{hash:{}}):o.call(e,"githubUrl","module/navigation/NavigationModule.js","NavigationModule",{hash:{}}),s+=a(n)+" asked current instance\n        of ",r=i.githubUrl,n=r?r.call(e,"module/navigation/activity/NavigationActivity.js","NavigationActivity",{hash:{}}):o.call(e,"githubUrl","module/navigation/activity/NavigationActivity.js","NavigationActivity",{hash:{}}),s+=a(n)+' to stop. But its too\n        smart - highlights active menu and always says "false" as a result of stop method - thus activity manager\n        wont start new activity and navigation view wont be rerendered. Quite useful trick.\n    </li>\n    <li>',r=i.githubUrl,n=r?r.call(e,"module/MainModule.js","MainModule",{hash:{}}):o.call(e,"githubUrl","module/MainModule.js","MainModule",{hash:{}}),s+=a(n)+" received place change event too, stopped previous manager\n        (that stopped its activity too) and started a new one\n        - ",r=i.githubUrl,n=r?r.call(e,"module/settings/SettingsModule.js","SettingsModule",{hash:{}}):o.call(e,"githubUrl","module/settings/SettingsModule.js","SettingsModule",{hash:{}}),s+=a(n)+"\n    </li>\n    <li>",r=i.githubUrl,n=r?r.call(e,"module/settings/SettingsModule.js","SettingsModule",{hash:{}}):o.call(e,"githubUrl","module/settings/SettingsModule.js","SettingsModule",{hash:{}}),s+=a(n)+' created and started managers for regions\n        below\n    </li>\n</ol>\n<br/>\n<div class="row-fluid">\n    <div class="span4 left-column"></div>\n    <div class="span8 right-column"></div>\n</div>'});return e.registerPartial("template_settings_SettingsModuleView",i),i}),define("module/settings/SettingsModuleView",["marionette","hbs!template/settings/SettingsModuleView"],function(t,e){var i=t.Layout.extend({template:e,regions:{leftColumn:".left-column",rightColumn:".right-column"}});return i}),define("module/settings/SettingsModule",["brix","module/settings/activity/SubSettingsActivity","module/settings/activity/LeftColumnActivity","module/settings/activity/RightColumnActivity","places/SettingsPlace","places/SubSettingsPlace","module/settings/SettingsModuleView"],function(t,e,i,n,r,s,o){var a=t.ActivityManager.extend({mapper:function(){return new i}}),l=t.ActivityManager.extend({mapper:function(t){return t instanceof s?new e:t instanceof r?new n:null}}),c=t.CompositeManager.extend({layoutView:o,regions:{leftColumn:a,rightColumn:l}});return c}),define("module/MainModule",["brix","places/ProfilePlace","module/profile/ProfileModule","places/SettingsPlace","module/settings/SettingsModule"],function(t,e,i,n,r){return t.DelegateManager.extend({mapper:function(t){return t instanceof e?new i:t instanceof n?new r:null}})}),define("hbs!template/settings/ModalWindowView",["hbs","handlebars","template/helpers/githubUrl"],function(t,e){var i=e.template(function(t,e,i){i=i||t.helpers;var n,r,s="",o=i.helperMissing,a=this.escapeExpression;return s+='<div class="modal-header" xmlns="http://www.w3.org/1999/html">\n    <h4>Modal Header</h4>\n</div>\n<div class="modal-body">\n    <p>When place was changed to ',r=i.githubUrl,n=r?r.call(e,"places/ModalWindowPlace.js","ModalWindowPlace",{hash:{}}):o.call(e,"githubUrl","places/ModalWindowPlace.js","ModalWindowPlace",{hash:{}}),s+=a(n)+", activity mapper\n        of ",r=i.githubUrl,n=r?r.call(e,"module/ModalWindowsModule.js","ModalWindowsModule",{hash:{}}):o.call(e,"githubUrl","module/ModalWindowsModule.js","ModalWindowsModule",{hash:{}}),s+=a(n)+" returned instance\n        of ",r=i.githubUrl,n=r?r.call(e,"module/settings/activity/ModalWindowActivity.js","ModalWindowActivity",{hash:{}}):o.call(e,"githubUrl","module/settings/activity/ModalWindowActivity.js","ModalWindowActivity",{hash:{}}),s+=a(n)+', that displayed this\n        modal window.</p>\n\n    <p>Now if you press "Refresh" - you will get the same screen with modal window, in other words application is still\n        bookmarkable.</p>\n\n    <p>Because ',r=i.githubUrl,n=r?r.call(e,"places/ModalWindowPlace.js","ModalWindowPlace",{hash:{}}):o.call(e,"githubUrl","places/ModalWindowPlace.js","ModalWindowPlace",{hash:{}}),s+=a(n)+" extends\n        from ",r=i.githubUrl,n=r?r.call(e,"places/SubSettingsPlace.js","SubSettingsPlace",{hash:{}}):o.call(e,"githubUrl","places/SubSettingsPlace.js","SubSettingsPlace",{hash:{}}),s+=a(n)+' - underlying layout is not rerendered.</p>\n\n    <p>And when you press "Refresh" all mappers of activity managers return appropriate Activities.</p>\n\n    <p>Places inheritance helps a lot in such situations and perfect reflects "logical" structure of a navigation.</p>\n</div>\n<div class="modal-footer">\n    <a href="#" class="btn">Close</a>\n</div>'
});return e.registerPartial("template_settings_ModalWindowView",i),i}),define("module/settings/view/ModalWindowView",["marionette","hbs!template/settings/ModalWindowView"],function(t,e){return t.ItemView.extend({className:"modal",template:e,triggers:{"click .btn":"close:me"}})}),define("module/settings/activity/ModalWindowActivity",["brix","module/settings/view/ModalWindowView","placeController","places/SubSettingsPlace"],function(t,e,i,n){return t.Activity.extend({start:function(t){this.view=new e,t.show(this.view),this.listenTo(this.view,"close:me",function(){i.gotoPlace(new n)})},stop:function(){this.view.close()}})}),define("module/ModalWindowsModule",["brix","places/ModalWindowPlace","module/settings/activity/ModalWindowActivity"],function(t,e,i){return t.ActivityManager.extend({mapper:function(t){return t instanceof e?new i:!0}})}),define("application",["jquery","MainLayout","placeController","module/navigation/NavigationModule","module/MainModule","module/ModalWindowsModule"],function(t,e,i,n,r,s){t(function(){var t=new e;$("body").empty().append(t.render().$el);var o=new n;o.start(i,t.navigationRegion);var a=new r;a.start(i,t.mainRegion);var l=new s;l.start(i,t.modalRegion),i.start()})});